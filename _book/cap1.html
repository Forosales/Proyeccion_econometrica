<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Variable dependiente binaria – Guía de Proyeccion Econométrica</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./cap2.html" rel="next">
<link href="./summary.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./cap1.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Variable dependiente binaria</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Guía de Proyeccion Econométrica</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Resumen</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cap1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Variable dependiente binaria</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cap2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Modelo Tobit</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cap3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelo Poisson</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cap4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modelo de Dos Partes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#el-modelo-de-probabilidad-lineal-mpl" id="toc-el-modelo-de-probabilidad-lineal-mpl" class="nav-link active" data-scroll-target="#el-modelo-de-probabilidad-lineal-mpl"><span class="header-section-number">3.1</span> El modelo de probabilidad lineal (MPL)</a>
  <ul class="collapse">
  <li><a href="#ejemplo-en-la-clase" id="toc-ejemplo-en-la-clase" class="nav-link" data-scroll-target="#ejemplo-en-la-clase"><span class="header-section-number">3.1.1</span> Ejemplo en la clase</a></li>
  </ul></li>
  <li><a href="#ejemplo-1-determinantes-de-la-denegación-en-solicitudes-de-hipoteca-en-el-mercado-inmobiliario-stock2012" id="toc-ejemplo-1-determinantes-de-la-denegación-en-solicitudes-de-hipoteca-en-el-mercado-inmobiliario-stock2012" class="nav-link" data-scroll-target="#ejemplo-1-determinantes-de-la-denegación-en-solicitudes-de-hipoteca-en-el-mercado-inmobiliario-stock2012"><span class="header-section-number">3.2</span> Ejemplo 1: Determinantes de la denegación en solicitudes de hipoteca en el mercado inmobiliario <span class="citation" data-cites="stock2012">(Stock and Watson 2012)</span></a>
  <ul class="collapse">
  <li><a href="#porcentaje-predicho-correctamente" id="toc-porcentaje-predicho-correctamente" class="nav-link" data-scroll-target="#porcentaje-predicho-correctamente"><span class="header-section-number">3.2.1</span> Porcentaje predicho correctamente</a></li>
  </ul></li>
  <li><a href="#ejemplo-2-determinantes-del-trabajo-femenino-wooldridge2009" id="toc-ejemplo-2-determinantes-del-trabajo-femenino-wooldridge2009" class="nav-link" data-scroll-target="#ejemplo-2-determinantes-del-trabajo-femenino-wooldridge2009"><span class="header-section-number">3.3</span> Ejemplo 2: Determinantes del trabajo femenino <span class="citation" data-cites="wooldridge2009">(Wooldridge 2009)</span></a>
  <ul class="collapse">
  <li><a href="#el-porcentaje-predicho-correctamente" id="toc-el-porcentaje-predicho-correctamente" class="nav-link" data-scroll-target="#el-porcentaje-predicho-correctamente"><span class="header-section-number">3.3.1</span> El porcentaje predicho correctamente</a></li>
  <li><a href="#interpretaciones-ceteris-paribus" id="toc-interpretaciones-ceteris-paribus" class="nav-link" data-scroll-target="#interpretaciones-ceteris-paribus"><span class="header-section-number">3.3.2</span> Interpretaciones ceteris paribus</a></li>
  <li><a href="#límites-del-mpl" id="toc-límites-del-mpl" class="nav-link" data-scroll-target="#límites-del-mpl"><span class="header-section-number">3.3.3</span> Límites del MPL</a></li>
  </ul></li>
  <li><a href="#ejemplo-3-un-modelo-de-probabilidad-lineal-para-arrestos-wooldridge2009" id="toc-ejemplo-3-un-modelo-de-probabilidad-lineal-para-arrestos-wooldridge2009" class="nav-link" data-scroll-target="#ejemplo-3-un-modelo-de-probabilidad-lineal-para-arrestos-wooldridge2009"><span class="header-section-number">3.4</span> Ejemplo 3: Un modelo de probabilidad lineal para arrestos <span class="citation" data-cites="wooldridge2009">(Wooldridge 2009)</span></a>
  <ul class="collapse">
  <li><a href="#porcentaje-predicho-correctamente-1" id="toc-porcentaje-predicho-correctamente-1" class="nav-link" data-scroll-target="#porcentaje-predicho-correctamente-1"><span class="header-section-number">3.4.1</span> Porcentaje predicho correctamente</a></li>
  <li><a href="#interpretaciones" id="toc-interpretaciones" class="nav-link" data-scroll-target="#interpretaciones"><span class="header-section-number">3.4.2</span> Interpretaciones</a></li>
  </ul></li>
  <li><a href="#incorporando-regresores-binarios-al-mpl" id="toc-incorporando-regresores-binarios-al-mpl" class="nav-link" data-scroll-target="#incorporando-regresores-binarios-al-mpl"><span class="header-section-number">3.5</span> Incorporando regresores binarios al MPL</a>
  <ul class="collapse">
  <li><a href="#interpretaciones-1" id="toc-interpretaciones-1" class="nav-link" data-scroll-target="#interpretaciones-1"><span class="header-section-number">3.5.1</span> Interpretaciones</a></li>
  <li><a href="#supuestos" id="toc-supuestos" class="nav-link" data-scroll-target="#supuestos"><span class="header-section-number">3.5.2</span> Supuestos</a></li>
  </ul></li>
  <li><a href="#modelos-logit-y-probit-para-la-respuesta-binaria" id="toc-modelos-logit-y-probit-para-la-respuesta-binaria" class="nav-link" data-scroll-target="#modelos-logit-y-probit-para-la-respuesta-binaria"><span class="header-section-number">3.6</span> Modelos Logit y Probit para la respuesta binaria</a>
  <ul class="collapse">
  <li><a href="#especificación-del-modelo-logit-y-probit" id="toc-especificación-del-modelo-logit-y-probit" class="nav-link" data-scroll-target="#especificación-del-modelo-logit-y-probit"><span class="header-section-number">3.6.1</span> Especificación del modelo logit y probit</a></li>
  <li><a href="#variables-aproximadamente-continuas" id="toc-variables-aproximadamente-continuas" class="nav-link" data-scroll-target="#variables-aproximadamente-continuas"><span class="header-section-number">3.6.2</span> Variables aproximadamente continuas:</a></li>
  <li><a href="#cuando-la-variable-explicativa-es-binaria" id="toc-cuando-la-variable-explicativa-es-binaria" class="nav-link" data-scroll-target="#cuando-la-variable-explicativa-es-binaria"><span class="header-section-number">3.6.3</span> Cuando la variable explicativa es binaria</a></li>
  <li><a href="#cuando-la-variable-explicativa-es-discreta" id="toc-cuando-la-variable-explicativa-es-discreta" class="nav-link" data-scroll-target="#cuando-la-variable-explicativa-es-discreta"><span class="header-section-number">3.6.4</span> Cuando la variable explicativa es discreta</a></li>
  <li><a href="#estimación-de-máxima-verosimilitud-de-los-modelos-logit-y-probit" id="toc-estimación-de-máxima-verosimilitud-de-los-modelos-logit-y-probit" class="nav-link" data-scroll-target="#estimación-de-máxima-verosimilitud-de-los-modelos-logit-y-probit"><span class="header-section-number">3.6.5</span> Estimación de máxima verosimilitud de los modelos Logit y Probit</a></li>
  <li><a href="#ejemplos-de-aplicación" id="toc-ejemplos-de-aplicación" class="nav-link" data-scroll-target="#ejemplos-de-aplicación"><span class="header-section-number">3.6.6</span> Ejemplos de aplicación</a></li>
  <li><a href="#interpretaciones-de-las-estimaciones-logit-y-probit" id="toc-interpretaciones-de-las-estimaciones-logit-y-probit" class="nav-link" data-scroll-target="#interpretaciones-de-las-estimaciones-logit-y-probit"><span class="header-section-number">3.6.7</span> Interpretaciones de las estimaciones Logit y Probit</a></li>
  <li><a href="#cálculo-de-la-speudo-r2-de-macfadden" id="toc-cálculo-de-la-speudo-r2-de-macfadden" class="nav-link" data-scroll-target="#cálculo-de-la-speudo-r2-de-macfadden"><span class="header-section-number">3.6.8</span> Cálculo de la speudo-<span class="math inline">\(R^2\)</span> de MacFadden</a></li>
  <li><a href="#efecto-parcial-promedio-y-el-efecto-parcial-en-el-promedio" id="toc-efecto-parcial-promedio-y-el-efecto-parcial-en-el-promedio" class="nav-link" data-scroll-target="#efecto-parcial-promedio-y-el-efecto-parcial-en-el-promedio"><span class="header-section-number">3.6.9</span> Efecto parcial promedio y el efecto parcial en el promedio</a></li>
  <li><a href="#porcentaje-predicho-correctamente-y-la-matriz-de-confusión" id="toc-porcentaje-predicho-correctamente-y-la-matriz-de-confusión" class="nav-link" data-scroll-target="#porcentaje-predicho-correctamente-y-la-matriz-de-confusión"><span class="header-section-number">3.6.10</span> Porcentaje predicho correctamente y la matriz de confusión</a></li>
  <li><a href="#capacidad-discriminante-del-modelo" id="toc-capacidad-discriminante-del-modelo" class="nav-link" data-scroll-target="#capacidad-discriminante-del-modelo"><span class="header-section-number">3.6.11</span> Capacidad discriminante del modelo</a></li>
  </ul></li>
  <li><a href="#ejercicio-17.2-del-libro-de-wooldridge" id="toc-ejercicio-17.2-del-libro-de-wooldridge" class="nav-link" data-scroll-target="#ejercicio-17.2-del-libro-de-wooldridge"><span class="header-section-number">4</span> Ejercicio 17.2 del libro de Wooldridge</a></li>
  <li><a href="#tareas" id="toc-tareas" class="nav-link" data-scroll-target="#tareas"><span class="header-section-number">5</span> Tareas</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Variable dependiente binaria</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="el-modelo-de-probabilidad-lineal-mpl" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="el-modelo-de-probabilidad-lineal-mpl"><span class="header-section-number">3.1</span> El modelo de probabilidad lineal (MPL)</h2>
<p>¿Qué ocurre cuando se desea usar la regresión múltiple para explicar eventos cualitativos?</p>
<p>El caso más sencillo es un evento del tipo binario, es decir, que <span class="math inline">\(y\)</span> toma valores de cero y uno. Por ejemplo, <span class="math inline">\(y\)</span> puede indicar si una persona trabaja o no trabaja, esta empleado o desempleado o, si una empresa es grande o pequeña. En cualquier caso se puede hacer que <span class="math inline">\(y=1\)</span> denota uno de los resultados o <span class="math inline">\(y=0\)</span> denota el otro resultado. También podría pensarse como éxito y fracaso. La demostración parte de la función de regresión poblacional.</p>
<p><span class="math display">\[
Y=\beta_0+\beta_1X_1+\beta_2X_2+...+\beta_kX_k+u \hspace{0.5cm}[1]
\]</span></p>
<p>Como <span class="math inline">\(y\)</span> solo puede toma dos valores, los <span class="math inline">\(\beta_j\)</span> <strong>no</strong> pueden interpretarse como una cambio en <span class="math inline">\(y\)</span> para un aumento de <span class="math inline">\(x_j\)</span> <strong>ceteris paribus</strong>. Recordar que en este caso <span class="math inline">\(y\)</span> cambia de cero a uno, o no cambia. Partiendo del supuesto de <strong>media condicional cero</strong> <span class="math inline">\(E(u|X_1, X_2,...,X_k)=0\)</span>, tenemos:</p>
<p><span class="math display">\[
E(y|\mathbf{X})=\beta_0+\beta_1X_1+\beta_2X_2+...+\beta_kX_k+u \hspace{1cm}[2]
\]</span></p>
<p>El punto clave es que <span class="math inline">\(y\)</span> es una variable binaria que toma valores de cero y uno, entonces tenemos que <span class="math inline">\(P(y=1|\mathbf{X})=E(y|\mathbf{X})\)</span>: la probabilidad de <strong>“éxito”</strong>. Por lo tanto, tenemos</p>
<p><span class="math display">\[
P(y=1|\mathbf{X})=\beta_0+\beta_1X_1+\beta_2X_2+...+\beta_kX_k+u \hspace{0.5cm} [3]
\]</span></p>
<p>La ecuación [3] dice que, la probabilidad de éxito, es decir <span class="math inline">\(p(x)=P(y=1|\mathbf{X})\)</span>, es una función lineal de las variables <span class="math inline">\(x_j\)</span>, también se le conoce como la <strong>probabilidad de respuesta</strong>. Dado que, las probabilidades deben sumar uno, <span class="math inline">\(P(y=0|\mathbf{X})=1-P(y=1|\mathbf{X})\)</span>, es también una función lineal de las <span class="math inline">\(x_j\)</span></p>
<p>Por lo tanto, a un modelo de regresión lineal múltiple en el que la variable dependiente es una variable binaria se le conoce como: <strong>El modelo de probabilidad lineal (MPL)</strong>, porque la probabilidad de respuesta es lineal a los parámetros <span class="math inline">\(\beta_j\)</span>. En el MPL, los <span class="math inline">\(\beta_j\)</span> miden la variación de la probabilidad de éxito de variar <span class="math inline">\(x_j\)</span> <strong>ceteris paribus</strong>:</p>
<p><span class="math display">\[
\Delta P(y=1|X)=\beta_j \Delta x_j \hspace{0.5cm} [4]
\]</span></p>
<section id="ejemplo-en-la-clase" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="ejemplo-en-la-clase"><span class="header-section-number">3.1.1</span> Ejemplo en la clase</h3>
<p>Los determinantes del desempleo</p>
<p><span class="math display">\[
P(de=1|educ)=\beta_0+\beta_1educ+u \hspace{0.5cm} ej1
\]</span></p>
<p><span class="math display">\[
P(de=1|educ)=0.23-1.04educ+u \hspace{0.5cm} ej2
\]</span></p>
<p>Donde:</p>
<ul>
<li><p>de: Desempleo, 1 si estas desempleado. 0 otro caso</p></li>
<li><p>educ: años de educación</p></li>
</ul>
<p>El modelo de regresión lineal múltiple permite estimar el efecto de diversas variables explicativas sobre un evento cualitativo. Entonces la mecánica de los <strong>MCO</strong> es la misma de siempre:</p>
<p><span class="math display">\[
\widehat{y}=\widehat{\beta}_0+\widehat{\beta}_1x_1+\widehat{\beta}_2x_2+...+\widehat{\beta}_kx_k \hspace{0.5cm} [5]
\]</span> Donde:</p>
<ul>
<li><p><span class="math inline">\(\widehat{y}\)</span>: es la probabilidad de éxito predicha</p></li>
<li><p><span class="math inline">\(\widehat{\beta}_0\)</span>: es la probabilidad de éxito cuando cada una de las <span class="math inline">\(x_j=0\)</span></p></li>
<li><p><span class="math inline">\(\widehat{\beta}_1\)</span>: mide la variación de la probabilidad de éxito predicha cuando <span class="math inline">\(x_1\)</span> varia en una unidad, mientras las demás permanecen constantes.</p></li>
<li><p><span class="math inline">\(\widehat{\beta}_j\)</span>: mide la variación de la probabilidad de éxito predicha cuando <span class="math inline">\(x_j\)</span> varia en una unidad, mientras las demás permanecen constantes.</p></li>
</ul>
<p><strong>¡¡Concepto clave: para interpretar correctamente un MPL, debe saberse qué es lo que constituye el éxito!!</strong></p>
<p><strong>Recomendación</strong>: la variable dependiente debe describir el nombre del evento cuando <span class="math inline">\(y=1\)</span></p>
<p>Por ejemplo, si estudiamos los determinantes del desempleo, la variable <span class="math inline">\(y\)</span> debe llamarse desempleo</p>
</section>
</section>
<section id="ejemplo-1-determinantes-de-la-denegación-en-solicitudes-de-hipoteca-en-el-mercado-inmobiliario-stock2012" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="ejemplo-1-determinantes-de-la-denegación-en-solicitudes-de-hipoteca-en-el-mercado-inmobiliario-stock2012"><span class="header-section-number">3.2</span> Ejemplo 1: Determinantes de la denegación en solicitudes de hipoteca en el mercado inmobiliario <span class="citation" data-cites="stock2012">(<a href="#ref-stock2012" role="doc-biblioref">Stock and Watson 2012</a>)</span></h2>
<ul>
<li><span class="math inline">\(denegar=1\)</span> le negaron la hipoteca y <span class="math inline">\(0\)</span> otro caso</li>
</ul>
<p>Variable explicativa:</p>
<ul>
<li><span class="math inline">\(\frac{P}{I}\)</span>: Ratio Pagos-ingresos</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(AER, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               stargazer,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               sandwich)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"HMDA"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(HMDA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   2380 obs. of  14 variables:
 $ deny     : Factor w/ 2 levels "no","yes": 1 1 1 1 1 1 1 1 2 1 ...
 $ pirat    : num  0.221 0.265 0.372 0.32 0.36 ...
 $ hirat    : num  0.221 0.265 0.248 0.25 0.35 ...
 $ lvrat    : num  0.8 0.922 0.92 0.86 0.6 ...
 $ chist    : Factor w/ 6 levels "1","2","3","4",..: 5 2 1 1 1 1 1 2 2 2 ...
 $ mhist    : Factor w/ 4 levels "1","2","3","4": 2 2 2 2 1 1 2 2 2 1 ...
 $ phist    : Factor w/ 2 levels "no","yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ unemp    : num  3.9 3.2 3.2 4.3 3.2 ...
 $ selfemp  : Factor w/ 2 levels "no","yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ insurance: Factor w/ 2 levels "no","yes": 1 1 1 1 1 1 1 1 2 1 ...
 $ condomin : Factor w/ 2 levels "no","yes": 1 1 1 1 1 1 2 1 1 1 ...
 $ afam     : Factor w/ 2 levels "no","yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ single   : Factor w/ 2 levels "no","yes": 1 2 1 1 1 1 2 1 1 2 ...
 $ hschool  : Factor w/ 2 levels "no","yes": 2 2 2 2 2 2 2 2 2 2 ...</code></pre>
</div>
</div>
<p>El objetivo es estimar la siguiente ecuación</p>
<p><span class="math display">\[
P(Y=1|x_1)=\beta_0+\beta_1x_1+u \hspace{0.5cm} [6]
\]</span></p>
<p>ahora usando nuestra ejemplo:</p>
<p><span class="math display">\[
P(deny=1|P/I)=\beta_0+\beta_1P/I+u\hspace{0.5cm} [7]
\]</span></p>
<p>Miremos las variables que ingresan. Primero hacemos binaria a la variable <em>deny</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>HMDA<span class="sc">$</span>deny <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(HMDA<span class="sc">$</span>deny<span class="sc">==</span><span class="st">"yes"</span>,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">1</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">0</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimar el modelo de probabilidad lineal</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>denymod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(deny<span class="sc">~</span>pirat, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>               HMDA)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(denymod1, </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
===============================================
                        Dependent variable:    
                    ---------------------------
                               deny            
-----------------------------------------------
pirat                        0.604***          
                              (0.061)          
                                               
Constant                     -0.080***         
                              (0.021)          
                                               
-----------------------------------------------
Observations                   2,380           
R2                             0.040           
Adjusted R2                    0.039           
Residual Std. Error      0.318 (df = 2378)     
F Statistic          98.406*** (df = 1; 2378)  
===============================================
Note:               *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p>Seria <span class="math inline">\(\widehat{\beta_1}=0.604\times0.01\approx 0.06\)</span></p>
<p>Una vez que tengo el MPL, puedo graficar</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> HMDA<span class="sc">$</span>pirat,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> HMDA<span class="sc">$</span>deny,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Gráfico de dispersión de las denegaciones de hipoteca y el ratio pagos-ingresos"</span>, </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"ratio P/I"</span>, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Denegar"</span>, </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>,<span class="fl">1.4</span>), </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.main =</span> <span class="fl">0.8</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Añadir las lineas horizontales</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"darkred"</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"darkred"</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">2.5</span>, <span class="fl">0.9</span>, </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>, </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>     <span class="st">"Hipoteca denegada"</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">2.5</span>, <span class="sc">-</span><span class="fl">0.1</span>, </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>, </span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>     <span class="st">"Hipoteca concedida"</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Añadiendo la linea del MPL</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(denymod1, </span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span><span class="fl">0.8</span>,</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.25</span>, <span class="fl">0.4</span>, </span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>, </span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>     <span class="st">"Modelo de probabilidad lineal"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cap1_files/figure-html/grafico-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Presentación de la regresión</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>eshr <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(denymod1, </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">"HC1"</span>))))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(denymod1,denymod1, </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">"text"</span>, </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">se =</span> eshr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
============================================================
                                    Dependent variable:     
                                ----------------------------
                                            deny            
                                     (1)            (2)     
------------------------------------------------------------
pirat                              0.604***      0.604***   
                                   (0.098)        (0.061)   
                                                            
Constant                           -0.080**      -0.080***  
                                   (0.032)        (0.021)   
                                                            
------------------------------------------------------------
Observations                        2,380          2,380    
R2                                  0.040          0.040    
Adjusted R2                         0.039          0.039    
Residual Std. Error (df = 2378)     0.318          0.318    
F Statistic (df = 1; 2378)        98.406***      98.406***  
============================================================
Note:                            *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p>Como los modelos de regresión lineal simple poseen el problema de sesgo de variable omitida, y de debido a que el gráfico muestra comportamientos que no son solo explicados por la variable independiente (<em>pirat</em>), se añade otra variable que puede ayudar a explicar el fenómeno. La variable es respecto a la conseción de hipoteca a las personas negras (<em>afam</em>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(HMDA)[<span class="dv">13</span>] <span class="ot">&lt;-</span> <span class="st">"negra"</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>denymod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(deny <span class="sc">~</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                 pirat <span class="sc">+</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                 negra, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> HMDA)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>eshr <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(denymod1, </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">"HC1"</span>))),</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(denymod2, </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">"HC1"</span>))))</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(denymod1, </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>          denymod2,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">"text"</span>,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">se =</span> eshr,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">df =</span> F, </span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">report =</span> <span class="st">"vcts*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
================================================
                        Dependent variable:     
                    ----------------------------
                                deny            
                         (1)            (2)     
------------------------------------------------
pirat                   0.604          0.597    
                      t = 6.128      t = 6.247  
                      (0.098)***    (0.096)***  
                                                
negrayes                               0.047    
                                     t = 3.387  
                                    (0.014)***  
                                                
Constant                -0.080        -0.096    
                      t = -2.500    t = -3.105  
                      (0.032)**     (0.031)***  
                                                
------------------------------------------------
Observations            2,380          2,380    
R2                      0.040          0.045    
Adjusted R2             0.039          0.044    
Residual Std. Error     0.318          0.318    
F Statistic           98.406***      55.614***  
================================================
Note:                *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p>Miremos los valores ajustados</p>
<p><span class="math inline">\(\widehat{y}_i\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># modelo con un solo regresor</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(denymod1<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.07991  0.08908  0.11926  0.11975  0.14340  1.73070 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># modelo con dos regresores</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(denymod2<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.09614  0.08800  0.11874  0.11975  0.14859  1.69459 </code></pre>
</div>
</div>
<section id="porcentaje-predicho-correctamente" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="porcentaje-predicho-correctamente"><span class="header-section-number">3.2.1</span> Porcentaje predicho correctamente</h3>
<p>Mirada a los valores ajustados</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>denymod2<span class="sc">$</span>fitted.values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            1             2             3             4             5 
 0.0357740938  0.1088880900  0.1259074499  0.0948681447  0.1187445298 
            6             7             8             9            10 
 0.0471153745  0.1596254083  0.0709917596  0.0888990484  0.0581507716 
           11            12            13            14            15 
 0.1178417344  0.1357490232  0.0709917596  0.1187445298  0.0113007969 
           16            17            18            19            20 
 0.1187445298  0.0411462782  0.0948681447  0.0888990484  0.1715636008 
           21            22            23            24            25 
 0.1247136260  0.1366518186  0.1417181195  0.1366518186  0.1476872157 
           26            27            28            29            30 
 0.1178417344  0.1715636008  0.1297799269  0.0888990484  0.1059035418 
           31            32            33            34            35 
 0.1655945046  0.1247136260  0.1596254083  0.1715636008  0.1068063372 
           36            37            38            39            40 
 0.1306827223  0.1664973000  0.1127754335  0.1306827223  0.1715636008 
           41            42            43            44            45 
 0.1247136260  0.1485900111  0.1127754335  0.1485900111  0.1536563120 
           46            47            48            49            50 
 0.0769608559  0.0650226633  0.1715636008  0.1068063372  0.1655945046 
           51            52            53            54            55 
 0.1536563120  0.0650226633  0.0462125791  0.1835017934  0.1187445298 
           56            57            58            59            60 
 0.0912866846  0.1068063372  0.1488810396  0.1476872157  0.1888739891 
           61            62            63            64            65 
 0.1080001610  0.1751450495  0.0954650452  0.0703948477  0.0930774204 
           66            67            68            69            70 
 0.0739763077  0.1217290779  0.1050156129  0.1596254083  0.1608192321 
           71            72            73            74            75 
 0.1127754335  0.1091939848  0.1178417344  0.1294888985  0.0578597432 
           76            77            78            79            80 
 0.0339833581  0.0411462782  0.0739763077  0.0620381152  0.1655945046 
           81            82            83            84            85 
 0.0662164871  0.1655945046  0.0888990484  0.1649976041  0.1408301905 
           86            87            88            89            90 
 0.1068063372  0.0345802700  0.1417181195  0.0948681447  0.1178417344 
           91            92            93            94            95 
 0.1354579948  0.0999344456  0.1068063372  0.1417181195  0.0900928722 
           96            97            98            99           100 
 0.1476872157  0.0948681447  0.1306827223  0.0948681447  0.0411462782 
          101           102           103           104           105 
 0.0650226633  0.1381366594  0.1596254083  0.1417181195  0.1175507060 
          106           107           108           109           110 
 0.1596254083  0.1068063372  0.1357490232  0.0769608559  0.2679719366 
          111           112           113           114           115 
 0.0608442914  0.1070973656  0.1187445298  0.2252854673  0.0859145003 
          116           117           118           119           120 
 0.1799203447  0.0614412033  0.1008372410  0.2312545636  0.0172698931 
          121           122           123           124           125 
 0.1297799269  0.1187445298  0.1476872157  0.0879962530  0.1485900111 
          126           127           128           129           130 
 0.1187445298  0.1485900111  0.1008372410  0.1238108307  0.1485900111 
          131           132           133           134           135 
 0.1008372410  0.0411462782  0.1366518186  0.1366518186  0.0650226633 
          136           137           138           139           140 
 0.1799203447  0.1787265209  0.1247136260  0.1447026676  0.1882770659 
          141           142           143           144           145 
 0.1864863415  0.1936492616  0.1303768388  0.1685790527  0.1094850019 
          146           147           148           149           150 
 0.0638288395  0.0644257514  0.1948430854  0.0877052246  0.1363459351 
          151           152           153           154           155 
 0.1187445298  0.1366518186  0.0948681447  0.0113007969  0.1068063372 
          156           157           158           159           160 
 0.1464933919  0.1798009601  0.1056125134  0.0715886715  0.1848746828 
          161           162           163           164           165 
 0.1205352541  0.0505774499  0.1319362271  0.0948681447  0.0745732196 
          166           167           168           169           170 
 0.1094850019  0.0918835965  0.1325853981  0.1524624882  0.1691759532 
          171           172           173           174           175 
 0.1253105266  0.1312796228  0.1596254083  0.1068063372  0.0621574998 
          176           177           178           179           180 
 0.1596254083  0.1835017934  0.1835017934  0.0829299521  0.0769608559 
          181           182           183           184           185 
 0.1127754335  0.1835017934  0.1655945046  0.1059035418  0.1655945046 
          186           187           188           189           190 
 0.0650226633  0.1638037802  0.0829299521  0.1366518186  0.0888990484 
          191           192           193           194           195 
 0.1605282037  0.1426209149  0.1536563120  0.1462023635  0.0411462782 
          196           197           198           199           200 
 0.3864510667  0.1775326971  0.1793234214  0.0948681447  0.0787515802 
          201           202           203           204           205 
 0.0941444263  0.0665075042  0.1261984669  0.1787265209  0.1774133125 
          206           207           208           209           210 
 0.1043590087  0.1836808590  0.1851731331  0.0709917596  0.0888990484 
          211           212           213           214           215 
 0.1799800257  0.1500748634  0.1238108307  0.1482244353  0.1518058840 
          216           217           218           219           220 
 0.1081792266  0.1313915857  0.0943309251  0.0508759001  0.0745732196 
          221           222           223           224           225 
 0.1118726381  0.1190355582  0.1443445136  0.1115816097  0.1273922907 
          226           227           228           229           230 
 0.0947487600  0.1895305706  0.0687831890  0.1610580014 -0.0222455235 
          231           232           233           234           235 
 0.1536563120  0.0301631402  0.0725437260  0.0763639440  0.0829299521 
          236           237           238           239           240 
 0.1187445298  0.0948681447  0.0948681447  0.0590535670  0.0590535670 
          241           242           243           244           245 
 0.1417181195  0.2014090822  0.1536563120  0.1247136260  0.1238108307 
          246           247           248           249           250 
 0.1596254083  0.1894708897  0.1655945046  0.1306827223  0.1247136260 
          251           252           253           254           255 
 0.1954399859  0.1417181195  0.1008372410  0.1008372410  0.1238108307 
          256           257           258           259           260 
 0.1715636008  0.1655945046  0.1247136260  0.1297799269  0.1068063372 
          261           262           263           264           265 
 0.1545591074  0.0232389894  0.0829299521  0.1306827223  0.1536563120 
          266           267           268           269           270 
 0.0769608559  0.0948681447  0.1187445298  0.1485900111  0.1417181195 
          271           272           273           274           275 
 0.1306827223  0.0700889642  0.1178417344  0.0530844708  0.0769608559 
          276           277           278           279           280 
 0.2431927561  0.1008372410  0.1724663962  0.1954399859  0.1127754335 
          281           282           283           284           285 
 0.1127754335 -0.0483901659  0.0999344456  0.1903736851  0.1187445298 
          286           287           288           289           290 
 0.0948681447  0.0650226633  0.1068063372  0.1476872157  0.0709917596 
          291           292           293           294           295 
 0.1068063372  0.1715636008  0.1297799269  0.1187445298  0.1158196626 
          296           297           298           299           300 
 0.0999344456 -0.0125755882  0.1664973000  0.1724663962  0.1247136260 
          301           302           303           304           305 
 0.1068063372  0.0652614326  0.0411462782  0.1536563120  0.1476872157 
          306           307           308           309           310 
 0.1745481490  0.1042396240  0.0697382548  0.1485900111  0.1204755732 
          311           312           313           314           315 
 0.0881827518  0.1223259784  0.1386738790  0.0681265961  0.1127754335 
          316           317           318           319           320 
 0.1492988745  0.0948681447  0.0615605879  0.1066272716  0.1066272716 
          321           322           323           324           325 
 0.1191026837  0.1287726133  0.0835268640  0.2730382375  0.1133723340 
          326           327           328           329           330 
 0.1829048929  0.1605282037  0.1605282037 -0.0066064920  0.1536563120 
          331           332           333           334           335 
 0.1357490232  0.1247136260  0.0888990484  0.0829299521 -0.0006373957 
          336           337           338           339           340 
 0.1187445298  0.1187445298  0.1426209149  0.1715636008  0.0709917596 
          341           342           343           344           345 
 0.1605282037  0.1187445298  0.0471153745  0.1844045888 -0.0015401911 
          346           347           348           349           350 
 0.0471153745  0.0351771819 -0.0125755882  0.0292080857 -0.0961429361 
          351           352           353           354           355 
 0.0761774451  0.1393379165  0.1297799269  0.1187445298  0.0709917596 
          356           357           358           359           360 
 0.0590535670  0.1178417344  0.0855563577  0.0910479267  0.0843028415 
          361           362           363           364           365 
 0.0229405391  0.0677087612  0.1405242957  0.1724663962  0.1168941017 
          366           367           368           369           370 
 0.1023220818  0.0943234919  0.0709917596  0.1994989732  0.1826661236 
          371           372           373           374           375 
 0.1072838759  0.1118726381  0.1127754335  0.1127754335  0.1417181195 
          376           377           378           379           380 
 0.1417181195  0.1715636008  0.1596254083  0.2133472748  0.1426209149 
          381           382           383           384           385 
 0.1238108307  0.1954399859  0.0530844708  0.1894708897  0.1605282037 
          386           387           388           389           390 
 0.1485900111  0.1963427813  0.1954399859  0.0590535670  0.1697728765 
          391           392           393           394           395 
 0.1835017934  0.1715636008  0.1476872157  0.0709917596  0.1655945046 
          396           397           398           399           400 
 0.1127754335  0.0948681447  0.1306827223  0.1127754335  0.1187445298 
          401           402           403           404           405 
 0.0530844708  0.2312545636  0.0113007969  0.1238108307  0.0530844708 
          406           407           408           409           410 
 0.0590535670  0.0769608559  0.1238108307  0.1118726381  0.1238108307 
          411           412           413           414           415 
 0.0292080857  0.4709212099  0.0530844708  0.0351771819  0.1247136260 
          416           417           418           419           420 
 0.1426209149  0.1238108307  0.1655945046  0.1417181195  0.1306827223 
          421           422           423           424           425 
 0.1247136260  0.1426209149  0.0939653493  0.1247136260  0.1596254083 
          426           427           428           429           430 
 0.1485900111  0.1485900111  0.1417181195  0.1068063372  0.1835017934 
          431           432           433           434           435 
 0.0465184626  0.1014341415  0.1626099564  0.1479334069  0.0491971272 
          436           437           438           439           440 
 0.0871083241  0.0441308264  0.0906897727  0.1094850019  0.0417431901 
          441           442           443           444           445 
 0.0853175884  0.1109847092  0.1602223088  0.0954650452  0.1312796228 
          446           447           448           449           450 
 0.2324483874  0.2043936303  0.0942712328 -0.0075689797  0.1074032377 
          451           452           453           454           455 
 0.1121785330  0.1056125134  0.1402332673  0.1835017934  0.1148571862 
          456           457           458           459           460 
 0.1360474735  0.2300607398  0.1358161488  0.0483091983  0.3169185078 
          461           462           463           464           465 
 0.2476770002  0.1152227621  0.2366267593  0.1163568822  0.1673852289 
          466           467           468           469           470 
 0.0614412033  0.0539723997  0.1217290779  0.1924554378  0.0542782946 
          471           472           473           474           475 
 0.0987406218  0.1840986939  0.1196324587  0.1321675632 -0.0627159975 
          476           477           478           479           480 
 0.1799203447  0.2993022702  0.1076942662  0.1015461043  0.0924805084 
          481           482           483           484           485 
 0.1644006808  0.1241167255  0.0832209805  0.1017251699  0.0136884331 
          486           487           488           489           490 
 0.1894708897  0.1536563120  0.1319884976  0.1485900111  0.0581507716 
          491           492           493           494           495 
 0.1426209149  0.1357490232  0.2202191664  0.1451802062  0.1849343865 
          496           497           498           499           500 
 0.0382214224  0.1316974578  0.1521640380  0.0462125791  0.1297799269 
          501           502           503           504           505 
 0.0103980015  0.0232389894 -0.0015401911  0.0103980015  0.0053317006 
          506           507           508           509           510 
 0.1238108307  0.1715636008  0.1655945046  0.0530844708  0.1187445298 
          511           512           513           514           515 
 0.1366518186  0.1775326971  0.1894708897  0.1655945046  0.1306827223 
          516           517           518           519           520 
 0.1476872157  0.1247136260  0.0351771819  0.0829299521  0.1655945046 
          521           522           523           524           525 
 0.1485900111  0.1596254083  0.1417181195  0.1485900111  0.0948681447 
          526           527           528           529           530 
 0.1426209149  0.1476872157  0.0709917596  0.1127754335  0.1426209149 
          531           532           533           534           535 
 0.0829299521  0.1596254083  0.0232389894  0.0769608559  0.1187445298 
          536           537           538           539           540 
 0.1536563120  0.0590535670  0.0709917596  0.1605282037  0.0650226633 
          541           542           543           544           545 
 0.1178417344  0.0650226633  0.1655945046  0.1127754335  0.1476872157 
          546           547           548           549           550 
 0.0948681447  0.0411462782  0.1247136260  0.1015535261  0.1604013972 
          551           552           553           554           555 
 0.1766447682  0.1142080266  0.1995586542  0.0346399624  0.0731928970 
          556           557           558           559           560 
 0.2259420715  0.1107459399  0.0928983434  0.1263849657  0.3452642933 
          561           562           563           564           565 
 0.1164762668  0.1273997239  0.0912866846  0.1798606410  0.1195801996 
          566           567           568           569           570 
 0.1097237598  0.0961216494  0.0418028825  0.1682806024  0.1584987100 
          571           572           573           574           575 
 0.0768414712  0.4367108464  0.1723992707  0.0807810738  0.1148646081 
          576           577           578           579           580 
 0.1112831594  0.2489827868  0.1272803393  0.1830316994  0.0129647147 
          581           582           583           584           585 
 0.0965394844  0.1257209396  0.1041799431  0.1525892947  0.0575612930 
          586           587           588           589           590 
 0.1173716404  0.1824944798  0.0327895457  0.0692010353  0.0650226633 
          591           592           593           594           595 
 0.0948681447  0.0999344456  0.2052964257  0.0948681447  0.1626099564 
          596           597           598           599           600 
 0.1357490232  0.1297799269  0.0641198679  0.0113007969 -0.0483901659 
          601           602           603           604           605 
 0.1187445298 -0.0125755882  0.1068063372  0.1068063372  0.0948681447 
          606           607           608           609           610 
 0.0172698931  0.0948681447  0.3864510667  0.2500646478  0.1297799269 
          611           612           613           614           615 
-0.0125755882  0.0590535670  0.1605282037  0.1844045888  0.0530844708 
          616           617           618           619           620 
 0.0829299521  0.0650226633  0.1187445298  0.0524875589  0.0327895457 
          621           622           623           624           625 
 0.5962722317  0.1187445298  0.0697979358  0.0948681447  0.0757670321 
          626           627           628           629           630 
 0.1921644094  0.0900928722  0.1279892026  0.1560439596  0.1199383536 
          631           632           633           634           635 
 0.0739763077  0.0966588690  0.1450085625  0.0924805084  0.1226170068 
          636           637           638           639           640 
 0.1175507060  0.0769608559  0.1127754335  0.1068063372  0.1187445298 
          641           642           643           644           645 
 0.0650226633  0.1724663962  0.0948681447  0.1476872157  0.1784354925 
          646           647           648           649           650 
 0.1596254083  0.1596254083  0.1366518186  0.1784354925  0.1306827223 
          651           652           653           654           655 
 0.0650226633  0.1306827223  0.0351771819  0.1775326971  0.1247136260 
          656           657           658           659           660 
 0.1247136260  0.0709917596  0.0999344456  0.0590535670  0.0650226633 
          661           662           663           664           665 
 0.1775326971  0.1127754335  0.0530844708  0.1306827223  0.1247136260 
          666           667           668           669           670 
 0.1118726381  0.0471153745  0.1187445298  0.0879962530  0.1008372410 
          671           672           673           674           675 
 0.0709917596  0.1476872157  0.1715636008  0.0948681447  0.1118726381 
          676           677           678           679           680 
 0.0709917596  0.1366518186  0.1306827223  0.1306827223  0.1775326971 
          681           682           683           684           685 
 0.0829299521  0.1366518186  0.1068063372  0.0172698931  0.1068063372 
          686           687           688           689           690 
 0.1476872157  0.0888990484  0.0769608559  0.0232389894  0.1724663962 
          691           692           693           694           695 
 0.0948681447  0.0232389894  0.0650226633  0.0283052903 -0.0066064920 
          696           697           698           699           700 
-0.0364519733  0.1306827223  0.0351771819  0.0351771819 -0.0185446845 
          701           702           703           704           705 
-0.0075092874  0.1655945046  0.1655945046  0.0509952848  0.0345802700 
          706           707           708           709           710 
 0.0906897727  0.1288919980  0.0229331059  0.0942712328  0.1169538054 
          711           712           713           714           715 
 0.1763388733  0.0787515802  0.1312796228  0.0897869773  0.1220201063 
          716           717           718           719           720 
 0.0500999226  0.0799454040  0.1384425429  0.1008372410  0.0817361283 
          721           722           723           724           725 
 0.1444116392  0.1342641710  0.1787265209  0.1139692573  0.1333613870 
          726           727           728           729           730 
 0.1426805958  0.0650226633  0.1805172453  0.0304019095  0.0083162487 
          731           732           733           734           735 
 0.1295411576  0.0578597432  0.0626350271  0.0957560736 -0.0036219438 
          736           737           738           739           740 
 0.0829299521  0.1420240144  0.0983824792  0.1396363667  0.1655945046 
          741           742           743           744           745 
 0.1605282037  0.1366518186  0.1008372410  0.1127754335  0.1008372410 
          746           747           748           749           750 
 0.1605282037  0.1238108307  0.0709917596  0.1894708897  0.1247136260 
          751           752           753           754           755 
 0.1008372410  0.0709917596  0.1187445298  0.2193163710  0.0829299521 
          756           757           758           759           760 
 0.1775326971  0.1238108307  0.1008372410  0.0292080857  0.0888990484 
          761           762           763           764           765 
 0.0641198679  0.1655945046  0.1127754335  0.1715636008  0.1536563120 
          766           767           768           769           770 
 0.1008372410  0.1357490232  0.1571183988  0.1545591074  0.1775326971 
          771           772           773           774           775 
 0.1596254083  0.1476872157  0.0471153745  0.1183789540  0.1417181195 
          776           777           778           779           780 
-0.0006373957  0.0530844708  0.1596254083  0.1775326971  0.1417181195 
          781           782           783           784           785 
 0.1596254083  0.1118726381  0.0530844708  0.0769608559  0.1125889347 
          786           787           788           789           790 
 0.1417181195  0.1357490232  0.1715636008  0.2969146226  0.1008372410 
          791           792           793           794           795 
 0.0462125791  0.1775326971  0.1068063372  0.1366518186  0.1724663962 
          796           797           798           799           800 
 0.2551309487  0.1605282037  0.1357490232  0.2252854673  0.0939653493 
          801           802           803           804           805 
 0.0351771819  0.0351771819  0.0581507716  0.3446673928  0.2560337441 
          806           807           808           809           810 
 0.1596254083  0.2611000449  0.1545591074  0.1485900111  0.1963427813 
          811           812           813           814           815 
 0.1784354925  0.0999344456  0.1835017934  0.1485900111  0.1059035418 
          816           817           818           819           820 
 0.1655945046  0.1835017934  0.1655945046  0.1017251699  0.4461420294 
          821           822           823           824           825 
 0.1068063372  0.0590535670  0.1178417344  0.1536563120  0.1715636008 
          826           827           828           829           830 
 0.0411462782  0.0888990484  0.1187445298  0.1485900111  0.1357490232 
          831           832           833           834           835 
 0.1664973000  0.1247136260  0.1366518186  0.1306827223  0.2193163710 
          836           837           838           839           840 
 0.1068063372  0.1536563120  0.1187445298  0.2261882627  0.1127754335 
          841           842           843           844           845 
 0.1008372410  0.1127754335  0.0888990484  0.0530844708  0.1247136260 
          846           847           848           849           850 
 0.0650226633  0.0650226633  0.1187445298  0.0292080857  0.1297799269 
          851           852           853           854           855 
 0.1068063372  0.0769608559  0.1894708897  0.0829299521  0.1059035418 
          856           857           858           859           860 
 0.0709917596  0.1366518186  0.0351771819  0.0715886715  0.1127754335 
          861           862           863           864           865 
 0.1199383536  0.1565214755  0.1211321774  0.0089131606  0.1271012737 
          866           867           868           869           870 
 0.1181476293  0.1202293706  0.1513283681  0.0560690189  0.1364056274 
          871           872           873           874           875 
 0.0984495933  0.1465530957  0.1306827223  0.0960619685  0.0924805084 
          876           877           878           879           880 
 0.0850117049  0.0841760350  0.0838178811  0.0515847635  0.2026029060 
          881           882           883           884           885 
 0.0985689780  0.0942712328  0.2133472748  0.1318765461  0.0853175884 
          886           887           888           889           890 
 0.1536563120  0.1429119433  0.1300858218  0.2918483217  0.1411212076 
          891           892           893           894           895 
 0.1470977371  0.1651169659  0.0206125838  0.1273922907  0.1638037802 
          896           897           898           899           900 
 0.1667883284  0.1333613870  0.1148571862  0.0873470820  0.1441057671 
          901           902           903           904           905 
 0.0399524544  0.1276384932  0.1444116392  0.1748540439  0.0697979358 
          906           907           908           909           910 
 0.0753491971  0.0626350271  0.1500748634  0.0545693116  0.1026279653 
          911           912           913           914           915 
 0.1026279653  0.1318765461  0.0017502405  0.0945622612  0.1279892026 
          916           917           918           919           920 
 0.1435088438  0.0769608559  0.1074032377  0.1978276336  0.0626350271 
          921           922           923           924           925 
 0.1055453992  0.1962831004  0.0626350271  0.0357740938  0.1448294741 
          926           927           928           929           930 
 0.0292080857  0.1321675632  0.1829048929  0.1276981742  0.1435088438 
          931           932           933           934           935 
 0.0942712328  0.0841237759  0.1664301744  0.0829299521  0.0286111738 
          936           937           938           939           940 
 0.1900677902  0.1008372410  0.0853175884 -0.0089941282  0.1715636008 
          941           942           943           944           945 
 0.0471153745  0.0292080857  0.0590535670  0.1775326971  0.0590535670 
          946           947           948           949           950 
 0.0113007969  0.0471153745  0.1178417344  0.0530844708  0.2193163710 
          951           952           953           954           955 
 0.1297799269  0.1068063372  0.1297799269  0.1178417344  0.1306827223 
          956           957           958           959           960 
 0.1068063372  0.1127754335  0.1476872157  0.1417181195  0.0820271567 
          961           962           963           964           965 
 0.1297799269  0.0590535670  0.1536563120  0.1178417344  0.1476872157 
          966           967           968           969           970 
 0.1426209149  0.0590535670  0.0232389894  0.1536563120  0.1008372410 
          971           972           973           974           975 
 0.1127754335  0.1655945046  0.1417181195  0.0948681447  0.0351771819 
          976           977           978           979           980 
 0.0709917596  0.0709917596  0.1357490232  0.1247136260  0.0948681447 
          981           982           983           984           985 
 0.1366518186  0.1366518186  0.0581507716  0.1775326971  0.1775326971 
          986           987           988           989           990 
 0.1059035418  0.1655945046  0.1118726381  0.0471153745  0.0530844708 
          991           992           993           994           995 
 0.1178417344  0.1366518186  0.1306827223 -0.0066064920  0.0411462782 
          996           997           998           999          1000 
 0.0232389894  0.0948681447  0.1127754335  0.2252854673  0.0292080857 
         1001          1002          1003          1004          1005 
 0.0888990484  0.1238108307  0.1357490232  0.1008372410  0.1008372410 
         1006          1007          1008          1009          1010 
 0.1605282037  0.1247136260  0.1536563120  0.2073781785  0.1655945046 
         1011          1012          1013          1014          1015 
 0.3694465733  0.1775326971  0.1247136260  0.1247136260  0.1545591074 
         1016          1017          1018          1019          1020 
 0.1008372410  0.1954399859  0.1306827223  0.1476872157  0.1835017934 
         1021          1022          1023          1024          1025 
 0.1118726381  0.3267601040  0.1605282037  0.1476872157  0.1775326971 
         1026          1027          1028          1029          1030 
 0.1247136260  0.0760580605  0.0760580605  0.0411462782  0.2909455263 
         1031          1032          1033          1034          1035 
 0.1118726381  0.1008372410  0.1844045888  0.1417181195  0.0769608559 
         1036          1037          1038          1039          1040 
 0.1844045888  0.2202191664  0.0888990484  0.1366518186  0.1187445298 
         1041          1042          1043          1044          1045 
 0.2014090822  0.1187445298  0.1596254083  0.1059035418  0.0351771819 
         1046          1047          1048          1049          1050 
-0.0125755882  0.0948681447  0.1178417344  0.1715636008  0.0709917596 
         1051          1052          1053          1054          1055 
 0.1238108307  0.0650226633  0.0999344456  0.0590535670  0.0829299521 
         1056          1057          1058          1059          1060 
 0.2023118776  0.1306827223  0.1426209149  0.1068063372  0.0948681447 
         1061          1062          1063          1064          1065 
 0.0590535670  0.0232389894  0.0769608559  0.1417181195  0.1835017934 
         1066          1067          1068          1069          1070 
 0.0641198679  0.1247136260  0.1485900111  0.1775326971  0.1008372410 
         1071          1072          1073          1074          1075 
 0.1590285078  0.1330703699  0.0888990484  0.1118726381  0.1402332673 
         1076          1077          1078          1079          1080 
 0.0590535670  0.1241167255  0.0888990484  0.1145661578  0.0686041234 
         1081          1082          1083          1084          1085 
 0.0888990484  0.1775326971  0.1247136260  0.1187445298  0.1127754335 
         1086          1087          1088          1089          1090 
 0.1655945046  0.1402332673  0.1655945046  0.1187445298  0.1118726381 
         1091          1092          1093          1094          1095 
 0.0888990484  0.1068063372  0.0769608559  0.1545591074  1.6945859460 
         1096          1097          1098          1099          1100 
 0.1476872157  0.1417181195  0.0829299521  0.0769608559  0.0709917596 
         1101          1102          1103          1104          1105 
 0.1247136260  0.1247136260  0.0641198679  0.1187445298  0.4461420294 
         1106          1107          1108          1109          1110 
 0.1238108307  0.1715636008  0.0292080857  0.0760580605  0.1238108307 
         1111          1112          1113          1114          1115 
 0.0760580605  0.2014090822  0.0351771819  0.0650226633  0.2073781785 
         1116          1117          1118          1119          1120 
 0.1247136260  0.1238108307  0.0053317006  0.1536563120 -0.0006373957 
         1121          1122          1123          1124          1125 
-0.0185446845  0.0888990484  0.0411462782  0.0700889642  0.0292080857 
         1126          1127          1128          1129          1130 
 0.0471153745  0.0351771819  0.0999344456  0.1536563120  0.1426209149 
         1131          1132          1133          1134          1135 
 0.0769608559  0.0769608559 -0.0125755882  0.1485900111  0.1715636008 
         1136          1137          1138          1139          1140 
 0.2073781785  0.0590535670  0.0879962530  0.0333864576  0.1715636008 
         1141          1142          1143          1144          1145 
 0.1020310648  0.1297799269  0.1253105266  0.1127754335  0.0521816754 
         1146          1147          1148          1149          1150 
 0.0601280062  0.0345802700  0.1115816097  0.1187445298  0.1605282037 
         1151          1152          1153          1154          1155 
 0.0650226633  0.1187445298  0.0650226633  0.1357490232  0.1127754335 
         1156          1157          1158          1159          1160 
 0.1655945046  0.0590535670  0.1187445298  0.0948681447  0.0709917596 
         1161          1162          1163          1164          1165 
 0.1536563120  0.0999344456  0.1127754335  0.0223361940  0.1008372410 
         1166          1167          1168          1169          1170 
 0.0590535670  0.0700889642  0.1357490232  0.0700889642  0.1247136260 
         1171          1172          1173          1174          1175 
 0.1357490232  0.1775326971  0.0769608559  0.1127754335  0.1894708897 
         1176          1177          1178          1179          1180 
 0.1068063372  0.1008372410  0.0888990484  0.1954399859  0.0471153745 
         1181          1182          1183          1184          1185 
 0.0939653493  0.1306827223  0.1476872157  0.0948681447  0.1247136260 
         1186          1187          1188          1189          1190 
 0.1306827223  0.1357490232  0.1357490232  0.1127754335  0.0888990484 
         1191          1192          1193          1194          1195 
 0.0939653493  0.1127754335  0.1715636008  0.0829299521  0.1357490232 
         1196          1197          1198          1199          1200 
 0.0053317006  0.1247136260  0.0471153745  0.1596254083  0.1596254083 
         1201          1202          1203          1204          1205 
 0.1417181195  0.1008372410  0.1127754335  0.1835017934  0.1178417344 
         1206          1207          1208          1209          1210 
 0.1426209149  0.2312545636  0.1775326971  0.1835017934  0.0948681447 
         1211          1212          1213          1214          1215 
 0.1247136260  0.1963427813  0.0053317006  0.1008372410  0.1008372410 
         1216          1217          1218          1219          1220 
 0.1118726381  0.1417181195  0.1127754335  0.1008372410  0.0769608559 
         1221          1222          1223          1224          1225 
 0.1417181195  0.1715636008  0.1059035418  0.1596254083  0.0590535670 
         1226          1227          1228          1229          1230 
 0.0888990484  0.1596254083  0.2790073338  0.0888990484  0.0471153745 
         1231          1232          1233          1234          1235 
 0.1536563120  0.0829299521  0.1008372410  0.1715636008  0.0530844708 
         1236          1237          1238          1239          1240 
 0.0769608559  0.1417181195  0.1187445298  0.0939653493 -0.0364519733 
         1241          1242          1243          1244          1245 
 0.1068063372  0.2073781785  0.1835017934  0.1357490232  0.1715636008 
         1246          1247          1248          1249          1250 
 0.0888990484  0.1715636008  0.0471153745  0.1247136260  0.1596254083 
         1251          1252          1253          1254          1255 
 0.0769608559  0.0769608559 -0.0543592622  0.1187445298  0.0530844708 
         1256          1257          1258          1259          1260 
 0.0292080857 -0.0185446845  0.1536563120  0.1366518186  0.1297799269 
         1261          1262          1263          1264          1265 
 0.0769608559  0.0053317006  0.1247136260  0.1664973000  0.1247136260 
         1266          1267          1268          1269          1270 
 0.0530844708  0.1059035418  0.3983892592  0.0551662235  0.0113007969 
         1271          1272          1273          1274          1275 
 0.1127754335  0.1154540981  0.1178417344  0.1008372410  0.0581507716 
         1276          1277          1278          1279          1280 
 0.2372236599  0.0172698931  0.1894708897  0.2321573590  0.1835017934 
         1281          1282          1283          1284          1285 
 0.3169185078  0.1462023635  0.1966338097  0.0829299521  0.1115816097 
         1286          1287          1288          1289          1290 
 0.1447026676  0.1181476293  0.0829299521  0.0632319390  0.1476872157 
         1291          1292          1293          1294          1295 
 0.0859145003  0.1417181195  0.1247136260  0.0495030107  0.0972557923 
         1296          1297          1298          1299          1300 
 0.1127754335  0.1306827223  0.0939653493  0.0900928722  0.0948681447 
         1301          1302          1303          1304          1305 
 0.1655945046  0.0089131606  0.1357490232  0.0650226633  0.1297799269 
         1306          1307          1308          1309          1310 
 0.1485900111  0.0172698931  0.0232389894  0.1894708897  0.1417181195 
         1311          1312          1313          1314          1315 
 0.1127754335  0.1715636008  0.1127754335  0.1008372410 -0.0066064920 
         1316          1317          1318          1319          1320 
 0.1068063372  0.1118726381  0.1068063372  0.0829299521  0.1417181195 
         1321          1322          1323          1324          1325 
 0.6679013869  0.1178417344  0.0471153745  0.0939653493  0.1306827223 
         1326          1327          1328          1329          1330 
 0.0948681447  0.1596254083  0.0999344456  0.2133472748 -0.0245137808 
         1331          1332          1333          1334          1335 
 0.0760580605  0.0471153745  0.1187445298  0.1417181195  0.1545591074 
         1336          1337          1338          1339          1340 
 0.1715636008  0.1476872157  0.0650226633  0.1297799269  0.2372236599 
         1341          1342          1343          1344          1345 
 0.0172698931  0.0172698931  0.0888990484  0.1187445298  0.0292080857 
         1346          1347          1348          1349          1350 
 0.1008372410  0.1655945046  0.1715636008  0.1127754335  0.2014090822 
         1351          1352          1353          1354          1355 
 0.1068063372  0.0471153745  0.1775326971  0.1306827223  0.0113007969 
         1356          1357          1358          1359          1360 
 0.1068063372  0.1476872157  0.0530844708  0.1306827223  0.1127754335 
         1361          1362          1363          1364          1365 
 0.1775326971  0.1715636008  0.1306827223  0.1187445298  0.1068063372 
         1366          1367          1368          1369          1370 
 0.1187445298  0.0411462782  0.1297799269  0.0769608559  0.1366518186 
         1371          1372          1373          1374          1375 
 0.1187445298  0.1178417344  0.1306827223  0.0590535670  0.1664973000 
         1376          1377          1378          1379          1380 
 0.1068063372  0.1068063372  0.1306827223  0.1306827223  0.1596254083 
         1381          1382          1383          1384          1385 
-0.0006373957  0.0888990484  0.1187445298  0.1357490232  0.2193163710 
         1386          1387          1388          1389          1390 
 0.1835017934  0.0700889642  0.0471153745  0.1724663962  0.3148219114 
         1391          1392          1393          1394          1395 
 0.1118726381  0.2321573590  0.1417181195  0.0521816754  0.1844045888 
         1396          1397          1398          1399          1400 
-0.0125755882  0.1775326971  0.0888990484  0.2202191664  0.1059035418 
         1401          1402          1403          1404          1405 
 0.0232389894  0.1476872157  0.0700889642  0.2142500702  0.1476872157 
         1406          1407          1408          1409          1410 
 0.0641198679  0.0793484921  0.1256015550  0.1518655877  0.0238359013 
         1411          1412          1413          1414          1415 
 0.1082911781  0.1176626574  0.2133472748  0.0634110046  0.1954399859 
         1416          1417          1418          1419          1420 
 0.0736181651  0.1297799269  0.1118726381  0.1492988745  0.0872873897 
         1421          1422          1423          1424          1425 
 0.1223856821  0.2128100552  0.0223361940  0.1187445298  0.1485900111 
         1426          1427          1428          1429          1430 
 0.1476872157  0.1306827223  0.1417181195  0.1417181195  0.1685790527 
         1431          1432          1433          1434          1435 
 0.0709917596  0.1127754335  0.0417431901  0.0888990484 -0.0280952408 
         1436          1437          1438          1439          1440 
 0.0829299521  0.1220201063  0.1605282037  0.1127754335  0.1476872157 
         1441          1442          1443          1444          1445 
 0.1545591074  0.2491618524  0.1894708897  0.1775326971  0.1476872157 
         1446          1447          1448          1449          1450 
 0.0820271567  0.1306827223  0.1306827223  0.1306827223  0.1775326971 
         1451          1452          1453          1454          1455 
 0.1306827223  0.1306827223  0.1306827223  0.1306827223  0.1306827223 
         1456          1457          1458          1459          1460 
 0.0411462782  0.0590535670 -0.0066064920  0.0053317006  0.0709917596 
         1461          1462          1463          1464          1465 
 0.1297799269  0.1297799269  0.0521816754  0.1775326971  0.1247136260 
         1466          1467          1468          1469          1470 
 0.1596254083  0.2482739235  0.1715636008  0.1229229017  0.1945520570 
         1471          1472          1473          1474          1475 
 0.1420240144  0.1199383536  0.1545591074  0.1611251042  0.1187445298 
         1476          1477          1478          1479          1480 
 0.1715636008  0.1536563120  0.1297799269  0.1775326971  0.1306827223 
         1481          1482          1483          1484          1485 
 0.1417181195  0.0530844708  0.1118726381  0.1894708897  0.1187445298 
         1486          1487          1488          1489          1490 
 0.0948681447  0.1775326971  0.0650226633  0.0829299521  0.1476872157 
         1491          1492          1493          1494          1495 
 0.0709917596  0.0769608559  0.0948681447  0.0888990484  0.1835017934 
         1496          1497          1498          1499          1500 
 0.0951069140  0.1228631980  0.1485303302  0.0590535670  0.1835017934 
         1501          1502          1503          1504          1505 
 0.0140988405  0.0948681447  0.1187445298  0.1306827223  0.0709917596 
         1506          1507          1508          1509          1510 
 0.1306827223  0.1357490232  0.1596254083 -0.0006373957  0.1476872157 
         1511          1512          1513          1514          1515 
 0.1835017934  0.0590535670  0.1187445298  0.1068063372  0.1187445298 
         1516          1517          1518          1519          1520 
 0.1476872157  0.1187445298  0.1247136260  0.0351771819  0.1068063372 
         1521          1522          1523          1524          1525 
 0.1068063372  0.1426209149 -0.0364519733  0.1894708897  0.0709917596 
         1526          1527          1528          1529          1530 
 0.1187445298  0.1835017934  0.0820271567  0.1655945046  0.1068063372 
         1531          1532          1533          1534          1535 
 0.1417181195  0.1366518186  0.1357490232  0.1247136260  0.1545591074 
         1536          1537          1538          1539          1540 
 0.0650226633  0.1715636008  0.1417181195  0.1238108307  0.1247136260 
         1541          1542          1543          1544          1545 
 0.1655945046  0.1187445298  0.1008372410  0.1238108307  0.0590535670 
         1546          1547          1548          1549          1550 
 0.0769608559  0.0948681447  0.0292080857  0.1417181195  0.0769608559 
         1551          1552          1553          1554          1555 
 0.1655945046  0.1187445298  0.0820271567  0.0530844708  0.1596254083 
         1556          1557          1558          1559          1560 
 0.1059035418  0.1476872157  0.0888990484  0.1068063372  0.0829299521 
         1561          1562          1563          1564          1565 
 0.1008372410  0.1366518186  0.1655945046  0.0709917596  0.1059035418 
         1566          1567          1568          1569          1570 
 0.1596254083  0.0769608559  0.1068063372  0.0829299521  0.0999344456 
         1571          1572          1573          1574          1575 
 0.0709917596  0.1655945046  0.1596254083  0.0888990484  0.0590535670 
         1576          1577          1578          1579          1580 
 0.0650226633  0.0948681447  0.1357490232  0.1306827223  0.0650226633 
         1581          1582          1583          1584          1585 
 0.0650226633  0.0879962530  0.1008372410  0.1297799269  0.1247136260 
         1586          1587          1588          1589          1590 
 0.1596254083  0.0829299521  0.3625746816  0.0471153745  0.0530844708 
         1591          1592          1593          1594          1595 
 0.1118726381  0.1238108307  0.1068063372  0.1008372410  0.2491618524 
         1596          1597          1598          1599          1600 
 0.2014090822  0.0948681447  0.1664973000  0.1775326971  0.1536563120 
         1601          1602          1603          1604          1605 
 0.0829299521  0.1835017934  0.0709917596  0.1417181195  0.1485900111 
         1606          1607          1608          1609          1610 
 0.1844045888  0.1596254083  0.0948681447  0.0769608559  0.1417181195 
         1611          1612          1613          1614          1615 
 0.0999344456  0.1068063372  0.1655945046  0.1476872157  0.0999344456 
         1616          1617          1618          1619          1620 
 0.0999344456  0.0650226633  0.0999344456  0.0411462782  0.0641198679 
         1621          1622          1623          1624          1625 
 0.0530844708  0.1059035418  0.0113007969  0.1068063372  0.1655945046 
         1626          1627          1628          1629          1630 
 0.1059035418  0.1775326971  0.1426209149  0.1297799269  0.0351771819 
         1631          1632          1633          1634          1635 
 0.0172698931  0.1835017934  0.1118726381  0.1655945046  0.0650226633 
         1636          1637          1638          1639          1640 
 0.1476872157  0.1417181195  0.1426209149  0.1187445298  0.0888990484 
         1641          1642          1643          1644          1645 
-0.0364519733  0.1118726381  0.1118726381  0.1715636008  0.1366518186 
         1646          1647          1648          1649          1650 
 0.0948681447  0.1306827223  0.1247136260  0.1536563120  0.1366518186 
         1651          1652          1653          1654          1655 
 0.0888990484  0.1127754335  0.0829299521  0.1118726381  0.0530844708 
         1656          1657          1658          1659          1660 
 0.1247136260  0.1068063372  0.1187445298  0.1476872157  0.1306827223 
         1661          1662          1663          1664          1665 
 0.1357490232  0.1297799269  0.1178417344  0.0888990484  0.0888990484 
         1666          1667          1668          1669          1670 
 0.1775326971  0.1068063372  0.1118726381  0.1178417344  0.0939653493 
         1671          1672          1673          1674          1675 
 0.1178417344  0.1357490232  0.0760580605  0.1536563120  0.0700889642 
         1676          1677          1678          1679          1680 
 0.1417181195  0.1426209149  0.1178417344  0.0888990484  0.0888990484 
         1681          1682          1683          1684          1685 
 0.1596254083  0.1247136260  0.0948681447  0.1068063372  0.1068063372 
         1686          1687          1688          1689          1690 
 0.1008372410  0.0351771819  0.1715636008  0.1963427813  0.1655945046 
         1691          1692          1693          1694          1695 
 0.1187445298  0.1536563120  0.1476872157  0.1178417344  0.1476872157 
         1696          1697          1698          1699          1700 
 0.1476872157  0.1187445298  0.1127754335  0.1715636008  0.0948681447 
         1701          1702          1703          1704          1705 
 0.1238108307  0.0650226633  0.1366518186  0.2014090822  0.1357490232 
         1706          1707          1708          1709          1710 
 0.1596254083  0.0769608559  0.0769608559  0.0709917596  0.1008372410 
         1711          1712          1713          1714          1715 
 0.2073781785  0.0888990484  0.1059035418  0.1068063372  0.1963427813 
         1716          1717          1718          1719          1720 
 0.1297799269  0.1476872157  0.1357490232  0.2193163710  0.0411462782 
         1721          1722          1723          1724          1725 
-0.0304828771  0.1715636008  0.0939653493  0.0172698931  0.1059035418 
         1726          1727          1728          1729          1730 
 0.1008372410  0.0650226633  0.0709917596  0.1247136260  0.0709917596 
         1731          1732          1733          1734          1735 
 0.2014090822  0.1366518186  0.0590535670  0.1008372410  0.1187445298 
         1736          1737          1738          1739          1740 
 0.1476872157  0.1844045888  0.2909455263  0.1655945046  0.1596254083 
         1741          1742          1743          1744          1745 
 0.0700889642 -0.0304828771  0.1247136260  0.0462125791  0.1297799269 
         1746          1747          1748          1749          1750 
 0.1127754335  0.1417181195  0.1008372410 -0.0185446845  0.0888990484 
         1751          1752          1753          1754          1755 
 0.0650226633  0.2849764300  0.1357490232  0.1357490232  0.1536563120 
         1756          1757          1758          1759          1760 
 0.0709917596  0.1247136260  0.1357490232  0.1417181195  0.1476872157 
         1761          1762          1763          1764          1765 
 0.0530844708  0.1844045888  0.0590535670  0.0948681447  0.1835017934 
         1766          1767          1768          1769          1770 
 0.1417181195  0.0530844708 -0.0304828771  0.1118726381  0.1357490232 
         1771          1772          1773          1774          1775 
 0.1655945046  0.0471153745  0.1655945046  0.1366518186  0.1596254083 
         1776          1777          1778          1779          1780 
 0.1476872157  0.1536563120  0.2551309487  0.0829299521  0.0471153745 
         1781          1782          1783          1784          1785 
 0.1297799269  0.1596254083  0.0879962530  0.0879962530  0.1187445298 
         1786          1787          1788          1789          1790 
 0.0709917596  0.1476872157  0.0888990484 -0.0254165762  0.1127754335 
         1791          1792          1793          1794          1795 
 0.0820271567  0.0590535670  0.0769608559  0.1357490232  0.1417181195 
         1796          1797          1798          1799          1800 
 0.1775326971  0.1068063372  0.1068063372  0.1238108307  0.1357490232 
         1801          1802          1803          1804          1805 
 0.0351771819  0.1536563120  0.1357490232  0.0888990484  0.0411462782 
         1806          1807          1808          1809          1810 
 0.1844045888  0.2014090822  0.1366518186  0.2014090822  0.1835017934 
         1811          1812          1813          1814          1815 
 0.1476872157  0.1178417344  0.2142500702 -0.0543592622  0.2133472748 
         1816          1817          1818          1819          1820 
 0.1187445298  0.2014090822  0.2133472748  0.1784354925  0.1844045888 
         1821          1822          1823          1824          1825 
 0.1306827223  0.1903736851  0.0709917596  0.1247136260  0.1596254083 
         1826          1827          1828          1829          1830 
 0.1426209149  0.1655945046  0.1068063372  0.1724663962  0.1426209149 
         1831          1832          1833          1834          1835 
 0.1306827223  0.0113007969  0.1306827223  0.1715636008  0.0462125791 
         1836          1837          1838          1839          1840 
 0.1715636008  0.0232389894  0.1417181195  0.1417181195  0.1655945046 
         1841          1842          1843          1844          1845 
 0.1068063372  0.1536563120  0.1187445298  0.0172698931  0.1536563120 
         1846          1847          1848          1849          1850 
 0.0879962530 -0.0125755882  0.1127754335  0.1008372410  0.0581507716 
         1851          1852          1853          1854          1855 
 0.1059035418  0.1068063372  0.1059035418  0.1059035418  0.0351771819 
         1856          1857          1858          1859          1860 
 0.0769608559  0.1238108307  0.0709917596  0.0530844708  0.1357490232 
         1861          1862          1863          1864          1865 
 0.1655945046  0.0471153745  0.1068063372  0.1247136260  0.1068063372 
         1866          1867          1868          1869          1870 
 0.0709917596  0.1187445298  0.1187445298  0.1127754335  0.0471153745 
         1871          1872          1873          1874          1875 
 0.1306827223  0.1127754335  0.1426209149  0.1426209149  0.1187445298 
         1876          1877          1878          1879          1880 
 0.1306827223  0.1426209149  0.1664973000  0.1485900111  0.1247136260 
         1881          1882          1883          1884          1885 
 0.1008372410  0.1366518186  0.1417181195  0.1306827223  0.0760580605 
         1886          1887          1888          1889          1890 
 0.2133472748  0.0172698931  0.1366518186  0.1426209149  0.1664973000 
         1891          1892          1893          1894          1895 
 0.1536563120  0.1655945046  0.0650226633  0.1366518186  0.1187445298 
         1896          1897          1898          1899          1900 
 0.1715636008  0.1187445298  0.1605282037  0.1366518186  0.1008372410 
         1901          1902          1903          1904          1905 
 0.2073781785  0.1068063372  0.0700889642  0.1178417344  0.2014090822 
         1906          1907          1908          1909          1910 
 0.1835017934  0.3924201630  0.0650226633  0.0939653493  0.1247136260 
         1911          1912          1913          1914          1915 
 0.2073781785  0.1536563120  0.2969146226  0.1426209149  0.1545591074 
         1916          1917          1918          1919          1920 
 0.2014090822  0.1247136260  0.1366518186  0.1835017934  0.1178417344 
         1921          1922          1923          1924          1925 
 0.1536563120  0.0530844708  0.1127754335  0.1008372410  0.1247136260 
         1926          1927          1928          1929          1930 
 0.0590535670  0.0471153745  0.7983187096  0.7983187096  0.1366518186 
         1931          1932          1933          1934          1935 
 0.1545591074  0.1485900111  0.1247136260  0.1059035418  0.1247136260 
         1936          1937          1938          1939          1940 
 0.2073781785  0.1894708897  0.2312545636  0.1187445298  0.1536563120 
         1941          1942          1943          1944          1945 
 0.0769608559  0.1835017934  0.0888990484  0.1426209149  0.1366518186 
         1946          1947          1948          1949          1950 
 0.1485900111  0.1775326971  0.1008372410  0.1835017934  0.0769608559 
         1951          1952          1953          1954          1955 
 0.1187445298  0.1187445298  0.1844045888  0.1536563120  0.1187445298 
         1956          1957          1958          1959          1960 
 0.1536563120  0.1775326971  0.1306827223  0.1426209149  0.2312545636 
         1961          1962          1963          1964          1965 
 0.1127754335  0.1485900111  0.1775326971  0.1306827223  0.0769608559 
         1966          1967          1968          1969          1970 
 0.1187445298  0.1835017934  0.1954399859  0.3267601040  0.1059035418 
         1971          1972          1973          1974          1975 
 0.0709917596  0.1357490232  0.0411462782  0.1545591074  0.1238108307 
         1976          1977          1978          1979          1980 
 0.0948681447  0.1596254083  0.1605282037  0.1485900111  0.1247136260 
         1981          1982          1983          1984          1985 
 0.1366518186  0.2252854673  0.1306827223  0.1008372410  0.1068063372 
         1986          1987          1988          1989          1990 
 0.0650226633  0.1187445298  0.1247136260  0.0530844708  0.1127754335 
         1991          1992          1993          1994          1995 
 0.0590535670  0.1068063372  0.1014341415  0.1276981742  0.0905629662 
         1996          1997          1998          1999          2000 
 0.1846956172  0.1118800600  0.0596504789  0.1429119433  0.0333864576 
         2001          2002          2003          2004          2005 
-0.0209323208  0.0906897727  0.0972557923  0.1312796228  0.1127754335 
         2006          2007          2008          2009          2010 
 0.0098010896  0.0814302448  0.1342641710  0.1199383536  0.0811392278 
         2011          2012          2013          2014          2015 
 0.1420240144  0.0751701315  0.1163568822  0.1109847092  0.1327644751 
         2016          2017          2018          2019          2020 
 0.0805423159  0.1265043504  0.0915777131  0.1032248886  0.1363459351 
         2021          2022          2023          2024          2025 
-0.0107848582  0.0787515802  0.0659105922  0.1624905718  0.1074032377 
         2026          2027          2028          2029          2030 
 0.1253105266  0.1536563120  0.1469709306  0.1139692573  0.1387932637 
         2031          2032          2033          2034          2035 
 0.1125366642  0.1566408602  0.1303768388  0.1050156129  0.1363459351 
         2036          2037          2038          2039          2040 
 0.1761598077  0.0954650452  0.1176104097  0.0990465166  0.1211321774 
         2041          2042          2043          2044          2045 
 0.0918239042  0.2145410986  0.1644006808  0.0972557923  0.1799203447 
         2046          2047          2048          2049          2050 
 0.1817110691  0.1195801996  0.1044186896  0.1579540686  0.0820271567 
         2051          2052          2053          2054          2055 
 0.0931967936  0.2599062211  0.1350327266  0.1005387907  0.0996434171 
         2056          2057          2058          2059          2060 
 0.1655945046  0.0912866846  0.1354579948  0.1721605014  0.1097908854 
         2061          2062          2063          2064          2065 
 0.1715636008  0.0965991881  0.1229229017  0.0817361283  0.1223259784 
         2066          2067          2068          2069          2070 
 0.0763639440  0.1253105266  0.0948681447  0.0883021365  0.1151630811 
         2071          2072          2073          2074          2075 
 0.1360549181  0.1345551994  0.1632068570  0.0930774204  0.0721855834 
         2076          2077          2078          2079          2080 
 0.0805423159  0.1235198022  0.1187445298  0.1267953788  0.1271535214 
         2081          2082          2083          2084          2085 
 0.1193414303  0.0703948477  0.0787515802  0.1262655811  0.0694994855 
         2086          2087          2088          2089          2090 
 0.1265640541  0.0136884331  0.0952262987  0.1217290779  0.1247136260 
         2091          2092          2093          2094          2095 
 0.0942712328  0.0868098624  0.1512686644  0.1211321774  0.0841237759 
         2096          2097          2098          2099          2100 
 0.1612370670  0.1513954937 -0.0030250319  0.0703948477  0.1870832420 
         2101          2102          2103          2104          2105 
 0.1287129096  0.1074032377  0.0434071023  0.1223259784  0.1715636008 
         2106          2107          2108          2109          2110 
 0.1638037802  0.1166479106  0.1057916018  0.0823330402  0.0894959603 
         2111          2112          2113          2114          2115 
 0.1336672705  0.1649976041  0.0978526928  0.1109847092  0.1441057671 
         2116          2117          2118          2119          2120 
 0.0811392278  0.0083759410  0.1239376372  0.0971364076  0.0892571910 
         2121          2122          2123          2124          2125 
 0.1159987510  0.0894959603  0.1211321774  0.1524624882  0.1047171626 
         2126          2127          2128          2129          2130 
 0.0381617301  0.0972557923  0.1439266787  0.0999344456  0.1655945046 
         2131          2132          2133          2134          2135 
 0.1127754335  0.1127754335  0.1596254083  0.1031592190  0.0834074794 
         2136          2137          2138          2139          2140 
 0.1315706513  0.1102684240  0.1414270911  0.0049138657  0.1072838759 
         2141          2142          2143          2144          2145 
 0.1210127927  0.0188815519  0.0099279074  0.1187445298  0.1420165697 
         2146          2147          2148          2149          2150 
 0.1664973000  0.1250643354  0.1396363667  0.1247136260  0.1664973000 
         2151          2152          2153          2154          2155 
 0.1715636008  0.1261387746  0.1693027825  0.1596254083  0.1649976041 
         2156          2157          2158          2159          2160 
 0.1835017934  0.1068063372  0.1388006969  0.0888990484  0.1307349814 
         2161          2162          2163          2164          2165 
 0.1589762487  0.1136111033  0.1366518186  0.1123575986  0.1260865155 
         2166          2167          2168          2169          2170 
 0.1040008547  0.1357564450  0.1550963270  0.0733793958  0.1151630811 
         2171          2172          2173          2174          2175 
 0.1890604766  0.1484706265  0.0198962987  0.1811215904  0.1546710475 
         2176          2177          2178          2179          2180 
 0.1403452301  0.1347342764  0.1618339675  0.1857700563  0.1379650271 
         2181          2182          2183          2184          2185 
 0.0235374397  0.2368655059  0.1366443854 -0.0283936911  0.0942115404 
         2186          2187          2188          2189          2190 
 0.1137901689  0.0496223954  0.0939130902  0.0654330650  0.1554544810 
         2191          2192          2193          2194          2195 
 0.1063885023 -0.0317363875  0.1106191334  0.1176700906  0.1703697770 
         2196          2197          2198          2199          2200 
 0.1022026971  0.0800647887  0.0788112725  0.1290636304  0.1523431036 
         2201          2202          2203          2204          2205 
 0.1239376372  0.1900081092  0.1127754335  0.1838002436  0.1895902743 
         2206          2207          2208          2209          2210 
 0.1398154323  0.1205352541  0.1229229017  0.1512089835  0.0953382387 
         2211          2212          2213          2214          2215 
 0.0516518890  0.1369502689  0.0961813531  0.1427328549  0.2053486848 
         2216          2217          2218          2219          2220 
 0.1353908806  0.1051349976  0.1059035418  0.1177297943  0.1142677076 
         2221          2222          2223          2224          2225 
 0.1196921510  0.0952859796  0.1614235772  0.1421359544  0.1414793502 
         2226          2227          2228          2229          2230 
 0.1423821456  0.0955247489  0.1799203447  0.0641198679 -0.0254165762 
         2231          2232          2233          2234          2235 
 0.1575959147  0.1927613327  0.1469112269  0.0749313622  0.0923611238 
         2236          2237          2238          2239          2240 
 0.1540218878  0.1762791924  0.2133472748  0.1429716242  0.1266834387 
         2241          2242          2243          2244          2245 
 0.0781546797  0.0847803688  0.0871680050  0.0948681447  0.1019116801 
         2246          2247          2248          2249          2250 
 0.1060303483  0.0945100021  0.0779756027  0.1005387907  0.1324734467 
         2251          2252          2253          2254          2255 
 0.0555914917  0.1393304832  0.1262655811  0.1645797691  0.1008372410 
         2256          2257          2258          2259          2260 
 0.1775923781  0.1398080105  0.1337866551  0.1568199258  0.0809601508 
         2261          2262          2263          2264          2265 
 0.0684847387  0.1431581344  0.1629681104  0.1310931240  0.0342818198 
         2266          2267          2268          2269          2270 
 0.0608442914  0.0966588690  0.1161181356  0.0877052246  0.1154540981 
         2271          2272          2273          2274          2275 
 0.1220872319  0.1022101304  0.1223185566  0.0603667641  0.1613564517 
         2276          2277          2278          2279          2280 
 0.1148049271  0.1303768388  0.1263252848  0.1596254083  0.1596254083 
         2281          2282          2283          2284          2285 
 0.0053317006  0.0521816754  0.0829299521  0.1068063372  0.2491618524 
         2286          2287          2288          2289          2290 
 0.0760580605  0.1187445298  0.0172698931  0.0948681447  0.1127754335 
         2291          2292          2293          2294          2295 
 0.0760580605  0.0709917596  0.0829299521  0.1187445298  0.0650226633 
         2296          2297          2298          2299          2300 
 0.1306827223  0.1536563120  0.1118726381  0.1247136260  0.0848997534 
         2301          2302          2303          2304          2305 
 0.0820942823  0.1248330107  0.1217290779  0.1223259784  0.1476872157 
         2306          2307          2308          2309          2310 
 0.1894708897  0.0650226633  0.0769608559  0.0888990484  0.1775326971 
         2311          2312          2313          2314          2315 
 0.1715636008  0.1775326971  0.1536563120  0.2014090822  0.0948681447 
         2316          2317          2318          2319          2320 
 0.1342641710  0.1578346840  0.0495030107  0.0411462782  0.1068063372 
         2321          2322          2323          2324          2325 
 0.1127754335  0.1769357966  0.1835017934  0.2014090822  0.0590535670 
         2326          2327          2328          2329          2330 
 0.1605282037  0.1068063372  0.0232389894  0.1187445298  0.0948681447 
         2331          2332          2333          2334          2335 
 0.1596254083  0.1844045888  0.1366518186  0.1068063372  0.1306827223 
         2336          2337          2338          2339          2340 
 0.1703697770  0.0829299521  0.1372487191  0.0829299521  0.1954399859 
         2341          2342          2343          2344          2345 
 0.1068063372  0.1059035418  0.1127754335 -0.0424210696  0.0590535670 
         2346          2347          2348          2349          2350 
 0.1664973000  0.1596254083  0.1366518186  0.0888990484  0.1426209149 
         2351          2352          2353          2354          2355 
 0.1485900111  0.0471153745  0.1008372410  0.1247136260  0.1127754335 
         2356          2357          2358          2359          2360 
 0.1545591074  0.1008372410  0.1068063372  0.1187445298  0.1417181195 
         2361          2362          2363          2364          2365 
 0.1417181195  0.0650226633  0.1008372410  0.1306827223  0.1187445298 
         2366          2367          2368          2369          2370 
 0.0939653493  0.0948681447  0.1775326971  0.1306827223  0.0999344456 
         2371          2372          2373          2374          2375 
 0.1417181195  0.1357490232  0.1008372410  0.1596254083  0.1008372410 
         2376          2377          2378          2379          2380 
 0.0888990484  0.1297799269  0.0590535670  0.1417181195  0.1596254083 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Porcentaje predicho correctamente</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>ppc <span class="ot">&lt;-</span><span class="fu">data.frame</span>(denymod2<span class="sc">$</span>model<span class="sc">$</span>deny, denymod2<span class="sc">$</span>fitted.values) </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ppc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  denymod2.model.deny denymod2.fitted.values
1                   0             0.03577409
2                   0             0.10888809
3                   0             0.12590745
4                   0             0.09486814
5                   0             0.11874453
6                   0             0.04711537</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cambiar de nombre</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ppc) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"deny"</span>, <span class="st">"VA"</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ppc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  deny         VA
1    0 0.03577409
2    0 0.10888809
3    0 0.12590745
4    0 0.09486814
5    0 0.11874453
6    0 0.04711537</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creando la variable y virgulilla</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>ppc<span class="sc">$</span>y.c <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(ppc<span class="sc">$</span>VA<span class="sc">&gt;</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ppc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  deny         VA y.c
1    0 0.03577409   0
2    0 0.10888809   0
3    0 0.12590745   0
4    0 0.09486814   0
5    0 0.11874453   0
6    0 0.04711537   0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(ppc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     deny         VA y.c
2375    0 0.10083724   0
2376    0 0.08889905   0
2377    0 0.12977993   0
2378    0 0.05905357   0
2379    1 0.14171812   0
2380    1 0.15962541   0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creando la variable PPC</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>ppc<span class="sc">$</span>ppc <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(ppc<span class="sc">$</span>deny<span class="sc">==</span>ppc<span class="sc">$</span>y.c,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ppc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  deny         VA y.c ppc
1    0 0.03577409   0   1
2    0 0.10888809   0   1
3    0 0.12590745   0   1
4    0 0.09486814   0   1
5    0 0.11874453   0   1
6    0 0.04711537   0   1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculando el PPC</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(ppc<span class="sc">$</span>ppc))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
       0        1 
11.84874 88.15126 </code></pre>
</div>
</div>
</section>
</section>
<section id="ejemplo-2-determinantes-del-trabajo-femenino-wooldridge2009" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="ejemplo-2-determinantes-del-trabajo-femenino-wooldridge2009"><span class="header-section-number">3.3</span> Ejemplo 2: Determinantes del trabajo femenino <span class="citation" data-cites="wooldridge2009">(<a href="#ref-wooldridge2009" role="doc-biblioref">Wooldridge 2009</a>)</span></h2>
<ul>
<li><p><span class="math inline">\(y\)</span>: <strong>inlf</strong>: (la fuerza de trabajo femenino), una variable binaria que indica, si una mujer casada participó en la fuerza de trabajo durante 1975: <span class="math inline">\(infl=1\)</span> la mujer informa haber trabajado fuera de la casa, por un salario ese año, cero otro caso</p></li>
<li><p><span class="math inline">\(x_1=nwifeinc\)</span> los ingreso del esposo en miles de dólares (-)</p></li>
<li><p><span class="math inline">\(x_2=educ\)</span> años de educación (+)</p></li>
<li><p><span class="math inline">\(x_3=exper\)</span> años de experiencia (+)</p></li>
<li><p><span class="math inline">\(x_4=exper^2\)</span> años de experiencia al cuadrado (-)</p></li>
<li><p><span class="math inline">\(x_5=edad\)</span> en años (-)</p></li>
<li><p><span class="math inline">\(x_6=kidslt6\)</span> hijo &lt; 6 años (-)</p></li>
<li><p><span class="math inline">\(x_7=kidsge6\)</span> hijos entres 6 y 18 años (+)</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"mroz"</span>, <span class="at">package =</span> <span class="st">"wooldridge"</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mroz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   753 obs. of  22 variables:
 $ inlf    : int  1 1 1 1 1 1 1 1 1 1 ...
 $ hours   : int  1610 1656 1980 456 1568 2032 1440 1020 1458 1600 ...
 $ kidslt6 : int  1 0 1 0 1 0 0 0 0 0 ...
 $ kidsge6 : int  0 2 3 3 2 0 2 0 2 2 ...
 $ age     : int  32 30 35 34 31 54 37 54 48 39 ...
 $ educ    : int  12 12 12 12 14 12 16 12 12 12 ...
 $ wage    : num  3.35 1.39 4.55 1.1 4.59 ...
 $ repwage : num  2.65 2.65 4.04 3.25 3.6 ...
 $ hushrs  : int  2708 2310 3072 1920 2000 1040 2670 4120 1995 2100 ...
 $ husage  : int  34 30 40 53 32 57 37 53 52 43 ...
 $ huseduc : int  12 9 12 10 12 11 12 8 4 12 ...
 $ huswage : num  4.03 8.44 3.58 3.54 10 ...
 $ faminc  : num  16310 21800 21040 7300 27300 ...
 $ mtr     : num  0.721 0.661 0.692 0.781 0.622 ...
 $ motheduc: int  12 7 12 7 12 14 14 3 7 7 ...
 $ fatheduc: int  7 7 7 7 14 7 7 3 7 7 ...
 $ unem    : num  5 11 5 5 9.5 7.5 5 5 3 5 ...
 $ city    : int  0 1 0 0 1 1 0 0 0 0 ...
 $ exper   : int  14 5 15 6 7 33 11 35 24 21 ...
 $ nwifeinc: num  10.9 19.5 12 6.8 20.1 ...
 $ lwage   : num  1.2102 0.3285 1.5141 0.0921 1.5243 ...
 $ expersq : int  196 25 225 36 49 1089 121 1225 576 441 ...
 - attr(*, "time.stamp")= chr "25 Jun 2011 23:03"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correr el modelo y crear el objeto</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>mroz.mpl <span class="ot">&lt;-</span> <span class="fu">lm</span>(inlf<span class="sc">~</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                 nwifeinc<span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                 educ<span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                 exper<span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">I</span>(exper<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>                 age<span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>                 kidslt6<span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>                 kidsge6,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> mroz)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co"># usando stargazer</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(mroz.mpl,</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">"text"</span>, </span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">digits =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
===============================================
                        Dependent variable:    
                    ---------------------------
                               inlf            
-----------------------------------------------
nwifeinc                    -0.00341**         
                             (0.00145)         
                                               
educ                        0.03800***         
                             (0.00738)         
                                               
exper                       0.03949***         
                             (0.00567)         
                                               
I(exper2)                   -0.00060***        
                             (0.00018)         
                                               
age                         -0.01609***        
                             (0.00248)         
                                               
kidslt6                     -0.26181***        
                             (0.03351)         
                                               
kidsge6                       0.01301          
                             (0.01320)         
                                               
Constant                    0.58552***         
                             (0.15418)         
                                               
-----------------------------------------------
Observations                    753            
R2                            0.26422          
Adjusted R2                   0.25730          
Residual Std. Error     0.42713 (df = 745)     
F Statistic          38.21795*** (df = 7; 745) 
===============================================
Note:               *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Punto de inflexión</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abs</span>((<span class="fu">coefficients</span>(mroz.mpl)[<span class="dv">4</span>])<span class="sc">/</span>(<span class="fu">coefficients</span>(mroz.mpl)[<span class="dv">5</span>]<span class="sc">*</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   exper 
33.11387 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Probar la multicolinealidad aproximada</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">vif</span>(mroz.mpl))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.417547</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalidad de los errores</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(mroz.mpl<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  mroz.mpl$residuals
X-squared = 36.741, df = 2, p-value = 1.051e-08</code></pre>
</div>
</div>
<p><span class="math display">\[
H_0: u\sim N(\mu, \sigma^2)
\]</span></p>
<section id="el-porcentaje-predicho-correctamente" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="el-porcentaje-predicho-correctamente"><span class="header-section-number">3.3.1</span> El porcentaje predicho correctamente</h3>
<p>Es una medida de bondad de ajuste</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>PPC.DTF <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mroz<span class="sc">$</span>inlf, mroz.mpl<span class="sc">$</span>fitted.values)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(PPC.DTF) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"infl"</span>, <span class="st">"VA.infl"</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>PPC.DTF<span class="sc">$</span>ajuste <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(mroz.mpl<span class="sc">$</span>fitted.values<span class="sc">&gt;=</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>PPC.DTF<span class="sc">$</span>PPC <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(PPC.DTF<span class="sc">$</span>infl<span class="sc">==</span>PPC.DTF<span class="sc">$</span>ajuste,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(PPC.DTF<span class="sc">$</span>PPC))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
       0        1 
26.56042 73.43958 </code></pre>
</div>
</div>
</section>
<section id="interpretaciones-ceteris-paribus" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="interpretaciones-ceteris-paribus"><span class="header-section-number">3.3.2</span> Interpretaciones ceteris paribus</h3>
<ul>
<li><p>Para interpretar las estimaciones, hay que recordar que una variación en la variable independiente modifica la probabilidad de que <span class="math inline">\(inlf=1\)</span>. Por ejemplo, <em>educ</em> si las demás variables permanecen constantes, una año más de educación hace que la probabilidad de participación en la fuerza laboral aumente en 3.8%. Si consideramos de forma literal a esta ecuación, entonces 10 años más educación incrementarían la probabilidad de permanecer en la fuerza laboral en 38%.</p></li>
<li><p>El coeficiente de <strong>nwifeinc</strong> significa que si <span class="math inline">\(\Delta nwifeinc=10\)</span> (un incremento de $10,000), la probabilidad de que una mujer permanecer en la fuerza de trabajo disminuye en 3.4%. Como se puede ver, esta disminución es pequeña a pesar de aumentar el salario en 10,000 dólares.</p></li>
<li><p>La experiencia ha sido introducida como una función cuadrática para que el efecto de la experiencia sea decreciente sobre la probabilidad de participar en la fuerza laboral. <em>Ceteris paribus</em>, la variación de la probabilidad se aproxima como <span class="math inline">\(0.039-2(0.0006)exper=0.039-0.0012exper\)</span>. El punto en el que la experiencia transcurrida no tiene efecto sobre la probabilidad de participación en la fuerza laboral es: <span class="math inline">\(0.039/0.0012=32.5\)</span>. Sólo 13 mujeres de las 753 en esta muestra tiene más de 32 años de experiencia.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>mroz<span class="sc">$</span>dico.exper <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(mroz<span class="sc">$</span>exper<span class="sc">&gt;</span><span class="fl">32.5</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mroz<span class="sc">$</span>dico.exper)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  0   1 
740  13 </code></pre>
</div>
</div>
<ul>
<li>A diferencia de la cantidad de hijos entre 6 y 18 años, la cantidad de hijos menores a 6 años tiene un impacto enorme sobre la probabilidad de participación en la fuerza de trabajo. A tal punto que, tener un hijo menor a seis años adicional, reduce la probabilidad de participación en la fuerza trabajo en 26.18%. En la muestra, menos de 20% de las mujeres tienen al menos un hijo pequeño.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>mroz<span class="sc">$</span>dic.hijo <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(mroz<span class="sc">$</span>kidslt6<span class="sc">&gt;=</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(mroz<span class="sc">$</span>dic.hijo))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
       0        1 
80.47809 19.52191 </code></pre>
</div>
</div>
<ul>
<li>Respecto al PPC el modelo predice en 73.44% a la variable <strong>infl</strong>.</li>
</ul>
</section>
<section id="límites-del-mpl" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="límites-del-mpl"><span class="header-section-number">3.3.3</span> Límites del MPL</h3>
<ul>
<li>Las dos desventajas más importantes son que las probabilidades ajustadas pueden ser menores que cero o mayores que uno.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mroz.mpl<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-0.3451  0.4016  0.5880  0.5684  0.7592  1.1272 </code></pre>
</div>
</div>
<p>Se demuestra para este ejemplo que algunos valores ajustados son menores que cero y mayores que uno.</p>
<ul>
<li>y, el efecto parcial de cualquier variable explicativa (si aparece en la ecuación en su nivel) es constante</li>
</ul>
</section>
</section>
<section id="ejemplo-3-un-modelo-de-probabilidad-lineal-para-arrestos-wooldridge2009" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="ejemplo-3-un-modelo-de-probabilidad-lineal-para-arrestos-wooldridge2009"><span class="header-section-number">3.4</span> Ejemplo 3: Un modelo de probabilidad lineal para arrestos <span class="citation" data-cites="wooldridge2009">(<a href="#ref-wooldridge2009" role="doc-biblioref">Wooldridge 2009</a>)</span></h2>
<p>Sea <strong>arr86</strong> una variable binaria igual a uno si un hombre fue arrestado en 1986 e igual a cero si no fue así. La población es un grupo de hombres de California nacidos en 1960 o en 1961, que habían sido detenidos al menos una vez antes de 1986. Un modelo de probabilidad lineal para describir <strong>arr86</strong> es:</p>
<p><span class="math display">\[arr86=\beta_0+\beta_1pcnv+\beta_2avgsen+\beta_3tottime+\beta_4ptime86+\beta_5qemp86+u\]</span> donde:</p>
<ul>
<li><p><span class="math inline">\(pcnv=\)</span> proporción de arrestos previos que condujeron a una condena (+)</p></li>
<li><p><span class="math inline">\(avgsen=\)</span> sentencia promedio cumplida en condenas previas (en meses) (-)</p></li>
<li><p><span class="math inline">\(tottime=\)</span> meses en prisión y desde los 18 años de edad anteriores a 1986 (-)</p></li>
<li><p><span class="math inline">\(ptime86=\)</span> meses en prisión en 1986 (+ -)</p></li>
<li><p><span class="math inline">\(qemp86=\)</span> cantidad de trimestres (0 a 4) que el hombre estuvo empleado legalmente en 1986.(-)</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"crime1"</span>, <span class="at">package =</span> <span class="st">"wooldridge"</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(crime1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   2725 obs. of  16 variables:
 $ narr86 : int  0 2 1 2 1 0 2 5 0 0 ...
 $ nfarr86: int  0 2 1 2 1 0 2 3 0 0 ...
 $ nparr86: int  0 0 0 1 0 0 1 5 0 0 ...
 $ pcnv   : num  0.38 0.44 0.33 0.25 0 ...
 $ avgsen : num  17.6 0 22.8 0 0 ...
 $ tottime: num  35.2 0 22.8 0 0 ...
 $ ptime86: int  12 0 0 5 0 0 0 0 9 0 ...
 $ qemp86 : num  0 1 0 2 2 4 0 0 0 3 ...
 $ inc86  : num  0 0.8 0 8.8 8.1 ...
 $ durat  : num  0 0 11 0 1 ...
 $ black  : int  0 0 1 0 0 0 1 0 1 0 ...
 $ hispan : int  0 1 0 1 0 0 0 0 0 1 ...
 $ born60 : int  1 0 1 1 0 1 1 1 1 1 ...
 $ pcnvsq : num  0.1444 0.1936 0.1089 0.0625 0 ...
 $ pt86sq : int  144 0 0 25 0 0 0 0 81 0 ...
 $ inc86sq: num  0 0.64 0 77.44 65.61 ...
 - attr(*, "time.stamp")= chr "25 Jun 2011 23:03"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creando la variable y</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(crime1<span class="sc">$</span>narr86)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   0    1    2    3    4    5    6    7    9   10   12 
1970  559  121   42   12   13    4    1    1    1    1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>crime1<span class="sc">$</span>arr86 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(crime1<span class="sc">$</span>narr86<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>arr86.MPL <span class="ot">&lt;-</span> <span class="fu">lm</span>(arr86<span class="sc">~</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>                  pcnv<span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>                  avgsen<span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>                  tottime<span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>                  ptime86<span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>                  qemp86,</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> crime1)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(arr86.MPL, </span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">digits =</span> <span class="dv">5</span>,</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
===============================================
                        Dependent variable:    
                    ---------------------------
                               arr86           
-----------------------------------------------
pcnv                        -0.16244***        
                             (0.02124)         
                                               
avgsen                        0.00611          
                             (0.00645)         
                                               
tottime                      -0.00226          
                             (0.00498)         
                                               
ptime86                     -0.02197***        
                             (0.00463)         
                                               
qemp86                      -0.04283***        
                             (0.00540)         
                                               
Constant                    0.44062***         
                             (0.01723)         
                                               
-----------------------------------------------
Observations                   2,725           
R2                            0.04735          
Adjusted R2                   0.04560          
Residual Std. Error     0.43731 (df = 2719)    
F Statistic         27.02966*** (df = 5; 2719) 
===============================================
Note:               *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<section id="porcentaje-predicho-correctamente-1" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="porcentaje-predicho-correctamente-1"><span class="header-section-number">3.4.1</span> Porcentaje predicho correctamente</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>PPC.arr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(crime1<span class="sc">$</span>arr86, arr86.MPL<span class="sc">$</span>fitted.values)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(PPC.arr)<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"arr86"</span>, <span class="st">"valores_ajustados"</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>PPC.arr<span class="sc">$</span>ajuste <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(PPC.arr<span class="sc">$</span>valores_ajustados<span class="sc">&gt;=</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>PPC.arr<span class="sc">$</span>PPC <span class="ot">&lt;-</span><span class="fu">ifelse</span>(PPC.arr<span class="sc">$</span>arr86<span class="sc">==</span>PPC.arr<span class="sc">$</span>ajuste,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(PPC.arr<span class="sc">$</span>PPC))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
       0        1 
27.70642 72.29358 </code></pre>
</div>
</div>
</section>
<section id="interpretaciones" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="interpretaciones"><span class="header-section-number">3.4.2</span> Interpretaciones</h3>
<ul>
<li><p><span class="math inline">\(\widehat{\beta}_0=0.44062\)</span>, es la probabilidad de ser arrestado que se predice a un hombre, que no ha sido condenado, que no ha estado en prisión despues de los 18 años, que no ha estado en prisión en 1986 y que ha estado desempleado todo el año</p></li>
<li><p><span class="math inline">\(\widehat{\beta}_2; \widehat{\beta}_3\)</span> que pertenecen a las variables <em>avgsen</em> y <em>tottime</em>, respectivamente. No son estadísticamente significativas (no tiene asteriscos). El signo de <em>avgsen</em> es contrauntuitivo, pues se esperaria que condenas más largas disminuyan la probabilidad de ser arrestado en 1986.Con respecto a <em>tottime</em>, según los datos haber tenido meses en prisión de los 18 y antes de 1986, disminuye la probabilidad de ser arrestado en 1986.</p></li>
<li><p><strong>ptimes86</strong> el aumento de probabilidad de ser condenado en 1986, disminuye la probabilidad de ser arrestado en promedio en 2.2%. Si un hombre esta en prisión no puede ser arrestado. Como <strong>ptimes86</strong> esta medida en mese, 6 meses más en prisión, reduce la probabilidad de ser detenido en <span class="math inline">\(0.0022\times6\approx0.132\)</span>. En esta variable se puede observar otra vez, que el MPL no cierto en todos los rangos de variables independientes. Por ejemplo, si un hombre está en prisión durante 12 meses de 1986, no puede ser detenido en 1986. <strong>Ceteris paribus</strong>, cuando <span class="math inline">\(ptimr86=12\)</span> la probabilidad predicha es de <span class="math inline">\(0.44-0.22\times12=0.177\)</span> que es distinta de cero</p></li>
<li><p><strong>qemp86</strong> tener un empleo reduce la probabilidad de detención de manera significativa. <strong>Ceteris paribus</strong> un hombre que ha sido empleado durante 4 trimestres, la probabilidad de ser detenido se reduce en <span class="math inline">\(0.04283\times\approx0.172\)</span></p></li>
</ul>
</section>
</section>
<section id="incorporando-regresores-binarios-al-mpl" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="incorporando-regresores-binarios-al-mpl"><span class="header-section-number">3.5</span> Incorporando regresores binarios al MPL</h2>
<p>En los modelos de variable dependiente binaria, se puede incluir variables independientes binarias. Este coeficiente mide la diferencia que se predice para la probabilidad en la relación con el grupo base. Así, incluimos regresores binarios en el MPL para <strong>arr86</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>arr86.MPL.bi <span class="ot">&lt;-</span> <span class="fu">lm</span>(arr86<span class="sc">~</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                  pcnv<span class="sc">+</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                  avgsen<span class="sc">+</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                  tottime<span class="sc">+</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>                  ptime86<span class="sc">+</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>                  qemp86<span class="sc">+</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>                    black<span class="sc">+</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>                    hispan,</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> crime1)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(arr86.MPL.bi, </span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">digits =</span> <span class="dv">5</span>,</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
===============================================
                        Dependent variable:    
                    ---------------------------
                               arr86           
-----------------------------------------------
pcnv                        -0.15206***        
                             (0.02107)         
                                               
avgsen                        0.00462          
                             (0.00639)         
                                               
tottime                      -0.00256          
                             (0.00493)         
                                               
ptime86                     -0.02370***        
                             (0.00459)         
                                               
qemp86                      -0.03847***        
                             (0.00540)         
                                               
black                       0.16976***         
                             (0.02367)         
                                               
hispan                      0.09619***         
                             (0.02071)         
                                               
Constant                    0.38043***         
                             (0.01873)         
                                               
-----------------------------------------------
Observations                   2,725           
R2                            0.06819          
Adjusted R2                   0.06579          
Residual Std. Error     0.43265 (df = 2717)    
F Statistic         28.40542*** (df = 7; 2717) 
===============================================
Note:               *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Limites del MPL</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(arr86.MPL.bi<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.05598  0.21483  0.26501  0.27706  0.36119  0.61273 </code></pre>
</div>
</div>
<section id="interpretaciones-1" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="interpretaciones-1"><span class="header-section-number">3.5.1</span> Interpretaciones</h3>
<ul>
<li>El coeficiente <strong>black</strong> significa que, <strong>ceteris paribus</strong> un hombre negro tiene una probabilidad del 17% mayor de ser detenido frente a un hombre blanco. Otra forma de expresar esto, es que la probabilidad de ser detenido es de 17 puntos porcentuales mayor para los negros que para los blancos.</li>
</ul>
<p>De la misma manera que la versión del modelo de regresión lineal múltiple en el MPL se puede verificar el cumplimento de los supuestos.</p>
</section>
<section id="supuestos" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="supuestos"><span class="header-section-number">3.5.2</span> Supuestos</h3>
<section id="homocedasticidad" class="level4" data-number="3.5.2.1">
<h4 data-number="3.5.2.1" class="anchored" data-anchor-id="homocedasticidad"><span class="header-section-number">3.5.2.1</span> Homocedasticidad</h4>
<ul>
<li><p>La <strong>homocedasticidad</strong> o varianza constante, su incumplimiento se conoce como <strong>heterocedásticidad</strong> o varianza no constante</p></li>
<li><p>Su incumplimento tiene efecto sobre la eficiencia de los estimadores de MCO.</p></li>
<li><p>Su incumplimiento, hace que las pruebas <span class="math inline">\(t\)</span> o <span class="math inline">\(f\)</span> se invaliden, pues el cálculo de la varianza supone homocedásticidad que no se cumple. Por lo tanto, la matriz de varianza covarianza esta mal calculada.</p></li>
<li><p>Existen dos formas de la heterocedasticidad, conocida y desconocida. Es común la forma desconocida, por tal motivo calculamos <strong>errores estándar heterocedástico robustos</strong></p></li>
</ul>
<p><strong>Hipótesis</strong></p>
<p><span class="math display">\[H_0:\sigma^2\]</span></p>
<p><span class="math display">\[H_a:\sigma^2_i\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de homcedasticidad</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># El test de Breusch-Pagan</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(mroz.mpl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  mroz.mpl
BP = 24.224, df = 7, p-value = 0.00104</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de Goldfeld-Quandt</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gqtest</span>(mroz.mpl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Goldfeld-Quandt test

data:  mroz.mpl
GQ = 2.488e+27, df1 = 369, df2 = 368, p-value &lt; 2.2e-16
alternative hypothesis: variance increases from segment 1 to 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>rob_es <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(mroz.mpl, <span class="at">type =</span> <span class="st">"HC1"</span>))))</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(mroz.mpl, mroz.mpl,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">se =</span> rob_es,</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">digits =</span> <span class="dv">5</span>,</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">"text"</span>,</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">column.labels =</span> <span class="fu">c</span>(<span class="st">"Heterocedástico-Robusto"</span>, <span class="st">"Homocedástico"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
====================================================================
                                        Dependent variable:         
                               -------------------------------------
                                               inlf                 
                               Heterocedástico-Robusto Homocedástico
                                         (1)                (2)     
--------------------------------------------------------------------
nwifeinc                             -0.00341**         -0.00341**  
                                      (0.00152)          (0.00145)  
                                                                    
educ                                 0.03800***         0.03800***  
                                      (0.00727)          (0.00738)  
                                                                    
exper                                0.03949***         0.03949***  
                                      (0.00581)          (0.00567)  
                                                                    
I(exper2)                            -0.00060***        -0.00060*** 
                                      (0.00019)          (0.00018)  
                                                                    
age                                  -0.01609***        -0.01609*** 
                                      (0.00240)          (0.00248)  
                                                                    
kidslt6                              -0.26181***        -0.26181*** 
                                      (0.03178)          (0.03351)  
                                                                    
kidsge6                                0.01301            0.01301   
                                      (0.01353)          (0.01320)  
                                                                    
Constant                             0.58552***         0.58552***  
                                      (0.15226)          (0.15418)  
                                                                    
--------------------------------------------------------------------
Observations                             753                753     
R2                                     0.26422            0.26422   
Adjusted R2                            0.25730            0.25730   
Residual Std. Error (df = 745)         0.42713            0.42713   
F Statistic (df = 7; 745)            38.21795***        38.21795*** 
====================================================================
Note:                                    *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
</section>
<section id="multicolinealidad-aproximada" class="level4" data-number="3.5.2.2">
<h4 data-number="3.5.2.2" class="anchored" data-anchor-id="multicolinealidad-aproximada"><span class="header-section-number">3.5.2.2</span> Multicolinealidad aproximada</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(regclass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: bestglm</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: leaps</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: VGAM</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: stats4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: splines</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Adjuntando el paquete: 'VGAM'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:AER':

    tobit</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lmtest':

    lrtest</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:car':

    logit</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: rpart</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: randomForest</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>randomForest 4.7-1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type rfNews() to see new features/changes/bug fixes.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Important regclass change from 1.3:
All functions that had a . in the name now have an _
all.correlations -&gt; all_correlations, cor.demo -&gt; cor_demo, etc.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VIF</span>(mroz.mpl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  nwifeinc       educ      exper I(exper^2)        age    kidslt6    kidsge6 
  1.170686   1.166001   8.636160   8.770985   1.658272   1.270358   1.250370 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">VIF</span>(mroz.mpl))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.417547</code></pre>
</div>
</div>
<p>En promedio el factor de inflación de la varianza es menor que 10. Por lo tanto, no debe preocuparme la multicolinealidad aproximada</p>
<p><strong>Normalidad de los errores</strong></p>
<p>La <span class="math inline">\(H_0\)</span>: los errores siguen una distribución normal</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(mroz.mpl<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  mroz.mpl$residuals
X-squared = 36.741, df = 2, p-value = 1.051e-08</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="modelos-logit-y-probit-para-la-respuesta-binaria" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="modelos-logit-y-probit-para-la-respuesta-binaria"><span class="header-section-number">3.6</span> Modelos Logit y Probit para la respuesta binaria</h2>
<p>El MPL es un modelo simple, que tiene varias desventajas. Las dos más importantes, como vimos en los ejemplos anteriores, son que las probabilidades ajustadas pueden ser menores que cero o mayores que uno y el efecto parcial de cualquier variable explicativa es constante. Esta limitaciones del MPL se superan con <strong>modelos de respuesta binaria</strong> más sofisticados.</p>
<p>En un modelo de respuesta binaria, el interés principal yace en la <strong>probabilidad de respuesta</strong></p>
<p><span class="math display">\[P(y=1|\mathbf{x})=P(y=1|x_1,x_2,...,x_k)[6]\]</span> Donde: <span class="math inline">\(\mathbf{x}\)</span> denota el conjunto total de variable explicativas. Por ejemplo, <span class="math inline">\(\mathbf{x}\)</span> podría contener varias características individuales como la educación, edad, estado civil, etc., que afecta, por ejemplo, al estado del empleo, incluye una variable de binaria para la participación en reciente programa de empleo</p>
<section id="especificación-del-modelo-logit-y-probit" class="level3" data-number="3.6.1">
<h3 data-number="3.6.1" class="anchored" data-anchor-id="especificación-del-modelo-logit-y-probit"><span class="header-section-number">3.6.1</span> Especificación del modelo logit y probit</h3>
<p>En el MPL, se suponía que la probabilidad de respuesta es lineal al conjunto de parámetros, <span class="math inline">\(\beta_j\)</span>. Para evitar las limitaciones del MPL, considere una clase de modelos de respuesta binaria de la forma:</p>
<p><span class="math display">\[P(y=1|\mathbf{x})=G(\beta_0+\beta_1X_1+\beta_2X_2+...+\beta_kX_k)=G(\beta_0+\mathbf{x\beta})[7]\]</span> donde <span class="math inline">\(G(.)\)</span> es una función que asume valores estrictamente entre 0 y 1: <span class="math inline">\(0&lt;G(.)&lt;1\)</span> para todos los número reales <span class="math inline">\(z\)</span>. Esto asegura que las probabilidades de respuesta estimada sean estrictamente entre cero y uno. Note que: <span class="math inline">\(\mathbf{x\beta}=\beta_1X_1+\beta_2X_2+...+\beta_kX_k\)</span></p>
<p>Se han sugerido varias funciones no lineales para la función <span class="math inline">\(G(.)\)</span> a fin de asegurar que las probabilidades estén entre cero y uno. Las dos funciones que estudiaremos en esta clase, se usan en la mayoría de aplicaciones (junto con el MPL). En el <strong>Modelo Logit</strong>, <span class="math inline">\(G(.)\)</span> es la función logística:</p>
<p><span class="math display">\[G(z)=\frac{exp(z)}{[1+exp(z)]}=\frac{e^z}{[1+e^z]}=\Lambda(z) [8]\]</span> Que está entre cero y uno para todos los números reales <span class="math inline">\(z\)</span>. Esta es la función de distribución acumulada (fda) para una variable aleatoria logística estándar.</p>
<p>En el <strong>Modelo Probit</strong>, <span class="math inline">\(G(.)\)</span> es la función de distribución acumulada normal estándar, que viene dada de la siguiente forma:</p>
<p><span class="math display">\[G(z)=\Phi(z)\equiv\int_{-\infty}^z \phi(v)dv[9]\]</span></p>
<p>Donde:</p>
<ul>
<li><span class="math inline">\(\phi(z)\)</span> es la función de densidad normal estándar</li>
</ul>
<p><span class="math display">\[\phi(z)=(2\pi)^{-1/2}exp(-z/2)=\frac{e^{-z/2}}{\sqrt{2\pi}}[10]\]</span> Esta elección de <span class="math inline">\(G(.)\)</span> asegura que <span class="math inline">\(0&lt;P(y=1|\mathbf{x})&lt;1\)</span>, para todos los valores de los parámetros y las <span class="math inline">\(x_j\)</span></p>
<p>Las funciones <span class="math inline">\(G(.)\)</span> de <strong>Logit</strong> y <strong>Probit</strong> son crecientes. Cada una aumenta con más rapidez en <span class="math inline">\(z=0\)</span>, <span class="math inline">\(G(z)\rightarrow 0\)</span> a medida que <span class="math inline">\(z\rightarrow -\infty\)</span> y, <span class="math inline">\(G(z)\rightarrow 1\)</span> a medida que <span class="math inline">\(z\rightarrow \infty\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">exp</span>(z)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(z))</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>z, </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"exp(z)/[1+exp(z)]"</span>, </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cap1_files/figure-html/funcion-logistica-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Los modelos Logit y Probit pueden derivarse a partir de un <strong>modelo de variable latente</strong> subyacente.</p>
<p>Sea <span class="math inline">\(y^*\)</span> una variable inobservable, o <em>latente</em> determianda por:</p>
<p><span class="math display">\[y^*=\beta_0+ \mathbf{x\beta}+e, y=1[y^*&gt;0][11]\]</span></p>
<p>Aquí se introduce la notación <span class="math inline">\(1[.]\)</span> para definir un resultado binario. La función <span class="math inline">\(1[.]\)</span> es la <strong>función indicador</strong>, que asume valor de uno si el evento dentro de los corchetes es verdadero y cero si es falso, Entonces tenemos:</p>
<p><span class="math display">\[y=1[y^*&gt;0][12]\]</span> <span class="math display">\[y=0[y^*\leq0]\]</span></p>
<p>Se supone que <span class="math inline">\(e\)</span> es independiente de <span class="math inline">\(\mathbf{x}\)</span> y que <span class="math inline">\(e\)</span> tiene un distribución logística estándar o normal estándar. En cualquier caso, <span class="math inline">\(e\)</span> se distribuye simétricamente en torno a cero, lo que significa que <span class="math inline">\(1-G(-Z)=G(z)\)</span> para todos los números reales de <span class="math inline">\(z\)</span>.</p>
<p>Los economistas tienden a favorecer el supuesto de normalidad para <span class="math inline">\(e\)</span>, lo cual es la razón por la que en Econometría el <strong>modelo Probit</strong> es más popular que el <strong>logit</strong>. Además, varios problemas de especificación, que se tratarán después, se analizan fácilmente mediante Probit debido a las propiedades de la distribución normal.</p>
<p>Dado estos supuestos podemos calcular la probabilidad de respuesta para <span class="math inline">\(y\)</span>:</p>
<p><span class="math display">\[P(y=1|\mathbf{x})=P(y^*&gt;0|\mathbf{x})=P(e&gt;-(\beta_0+\mathbf{x\beta})|\mathbf{x})=\\1-G[-(\beta_0+\mathbf{x\beta})]=G(\beta_0+\mathbf{x\beta})[13]\]</span> uno de los objetivos de los modelos de respuesta binaria, es explicar los efectos de las <span class="math inline">\(x_j\)</span> sobre la probabilidad de respuesta <span class="math inline">\(P(y=1|\mathbf{x})\)</span>.Cuidado, la formula de la variable latente tiende a dar la impresión de que lo que principalmente interesa son los efectos de cada <span class="math inline">\(x_j\)</span> sobre <span class="math inline">\(y^*\)</span>. Hay que aclarar que en los modelos Logit y Probit la dirección de efectos de <span class="math inline">\(x_j\)</span> sobre <span class="math inline">\(E(y|\mathbf{x})=P(y=1|\mathbf{x})=G(\beta_0+\mathbf{x\beta})\)</span></p>
<p>Aclarando que:</p>
<p><span class="math display">\[E(y^*|\mathbf{x})=\beta_0+\mathbf{x\beta}-[14]\]</span> Como la variable latente pocas veces tiene una unidad de medición definida, las magnitudes de cada <span class="math inline">\(\beta_j\)</span> no son, útiles por sí mismas, a diferencia de las magnitudes calculadas por el <strong>MPL</strong>. Entonces para la mayoría de los propósitos, se requiere estimar el efecto de <span class="math inline">\(x_j\)</span> sobre la probabilidad de éxito <span class="math inline">\(P(y=1|\mathbf{x})\)</span>, esto se complicado por la naturaleza no lineal de <span class="math inline">\(G(.)\)</span>. Esto nos lleva a definir tres casos de efectos parciales:</p>
</section>
<section id="variables-aproximadamente-continuas" class="level3" data-number="3.6.2">
<h3 data-number="3.6.2" class="anchored" data-anchor-id="variables-aproximadamente-continuas"><span class="header-section-number">3.6.2</span> Variables aproximadamente continuas:</h3>
<p>Para hallar el efecto parcial de las variables aproximadamente continuas sobre la probabilidad de respuesta, se recurre al cálculo. Si <span class="math inline">\(x_j\)</span> es una variable aproximadamente continua, su efecto parcial sobre <span class="math inline">\(p(x)=P(y=1|\mathbf{x})\)</span> se obtiene de la siguiente derivada parcial:</p>
<p><span class="math display">\[\frac{\partial p(\mathbf{x})}{\partial x_j}=g(\beta_0+\mathbf{x\beta})\beta_j[15]\]</span></p>
<p>Donde:</p>
<p><span class="math display">\[g(z)\equiv\frac{dG}{dz}(z) [16]\]</span> Debido a que <span class="math inline">\(G\)</span> es la fda de una variable aleatoria continua, <span class="math inline">\(g\)</span> es la función de densidad de probabilidad.</p>
<p>En los casos de logit y probit, <span class="math inline">\(G(.)\)</span> es una fda estrictamente creciente y, por lo tanto, <span class="math inline">\(g(z)&gt;0\forall z\)</span>. Por lo tanto, el efecto parcial de <span class="math inline">\(x_j\)</span> sobre <span class="math inline">\(p(\mathbf{x})\)</span> depende de <span class="math inline">\(\mathbf{x}\)</span> a través de la cantidad positiva <span class="math inline">\(g(\beta_0+\mathbf{x\beta})\)</span>, lo que significa que el efecto parcial siempre tiene el mismo signo que <span class="math inline">\(\beta_j\)</span></p>
<p>La ecuación de la derivada parcial muestra que los efectos <em>relativos</em> del cualquiera las variables explicativas continuas no depende de <span class="math inline">\(\mathbf{x}\)</span>, la razón de los efectos parciales de <span class="math inline">\(x_j\)</span> y <span class="math inline">\(x_h\)</span> es <span class="math inline">\(\frac{\beta_j}{\beta_h}\)</span>. El caso típico de que <span class="math inline">\(g\)</span> sea un densidad simétrica en torno a cero, con una única moda en cero, el mayor efecto ocurre cuando <span class="math inline">\(\beta_0+\mathbf{x\beta}=0\)</span>. Por ejemplo:</p>
<section id="en-el-caso-de-probit" class="level4" data-number="3.6.2.1">
<h4 data-number="3.6.2.1" class="anchored" data-anchor-id="en-el-caso-de-probit"><span class="header-section-number">3.6.2.1</span> En el caso de Probit</h4>
<p><span class="math display">\[g(z)=\phi(z)=\frac{e^{-z/2}}{\sqrt{2\pi}}\]</span> <span class="math display">\[g(0)=\frac{e^{-0/2}}{\sqrt{2\pi}}=\frac{1}{\sqrt{2\pi}}\approx 0.40\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3989423</code></pre>
</div>
</div>
</section>
<section id="en-el-caso-logit" class="level4" data-number="3.6.2.2">
<h4 data-number="3.6.2.2" class="anchored" data-anchor-id="en-el-caso-logit"><span class="header-section-number">3.6.2.2</span> En el caso logit</h4>
<p><span class="math display">\[g(z)=\frac{e^z}{[1+e^z]^2}\]</span> Evaluando cuando <span class="math inline">\(z=0\)</span></p>
<p><span class="math display">\[g(0)=\frac{e^0}{[1+e^0]^2}\]</span></p>
<p><span class="math display">\[g(0)=\frac{1}{[1+1]^2}=\frac{1}{4}=0.25\]</span></p>
</section>
</section>
<section id="cuando-la-variable-explicativa-es-binaria" class="level3" data-number="3.6.3">
<h3 data-number="3.6.3" class="anchored" data-anchor-id="cuando-la-variable-explicativa-es-binaria"><span class="header-section-number">3.6.3</span> Cuando la variable explicativa es binaria</h3>
<p>Entonces el efecto parcial de cambiar<span class="math inline">\(x_1\)</span> de cero a uno, manteniendo constante todas las demás variables, es así:</p>
<p><span class="math display">\[G(\beta_0+\beta_1+\beta_2x_2+...+\beta_kx_k)-G(\beta_0+\beta_2x_2+...+\beta_kx_k) [17]\]</span></p>
<p>De nuevo, esto depende de todos los valores de las otras <span class="math inline">\(x_j\)</span>. Por ejemplo, si <span class="math inline">\(y\)</span> es un indicador de empleo y <span class="math inline">\(x_1\)</span> es una variable binaria que indica la participación en un programa de capacitación laboral, entonces es el cambio en la probabilidad de empleo debido a este programa de capacitación; esto depende de las demás características que afectan la posibilidad de obtener el empleo, como la educación y la experiencia. Observe que saber el signo del <span class="math inline">\(\beta_1\)</span> es suficiente para determinar si el programa tuvo un efecto positivo o negativo. Pero para hallar la <strong>magnitud</strong> del efecto, se tiene que estimar la cantidad usando la anterior ecuación [17].</p>
</section>
<section id="cuando-la-variable-explicativa-es-discreta" class="level3" data-number="3.6.4">
<h3 data-number="3.6.4" class="anchored" data-anchor-id="cuando-la-variable-explicativa-es-discreta"><span class="header-section-number">3.6.4</span> Cuando la variable explicativa es discreta</h3>
<p>Por ejemplo, el número de hijos. Si <span class="math inline">\(x_k\)</span> denota esta variable, el efecto sobre la probabilidad de que <span class="math inline">\(x_k\)</span> cambien de <span class="math inline">\(c_k\)</span> a <span class="math inline">\(c_k+1\)</span> es simplemente:</p>
<p><span class="math display">\[G[\beta_0+\beta_1x_1+\beta_2x_2+...+\beta_k(c_k+1)]-G[\beta_0+\beta_1x_1+\beta_2x_2+...+\beta_kc_k]\]</span></p>
</section>
<section id="estimación-de-máxima-verosimilitud-de-los-modelos-logit-y-probit" class="level3" data-number="3.6.5">
<h3 data-number="3.6.5" class="anchored" data-anchor-id="estimación-de-máxima-verosimilitud-de-los-modelos-logit-y-probit"><span class="header-section-number">3.6.5</span> Estimación de máxima verosimilitud de los modelos Logit y Probit</h3>
<p>Para los MPL se uso mínimos cuadrados ordinarios (MCO) o, si existe heterocedasticidad, mínimos cuadrados ponderados (MCP). Ahora bien, debido a naturaleza no lineal <span class="math inline">\(E(y|\mathbf{x})\)</span>, MCO y MCP no son aplicables, por esta razón se usa la <strong>estimación de máxima verosimilitud (EMV)</strong>. Para estimar los modelos de variables dependientes limitadas, los métodos de máxima verosimilitud son indispensables. Como la EMV está basada en la distribución de <span class="math inline">\(y\)</span> dada <span class="math inline">\(\mathbf{x}\)</span>, la heterocedasticidad en <span class="math inline">\(Var(y|\mathbf{x})\)</span> automáticamente se toma en cuenta.</p>
<p>Suponiendo que se tiene una muestra aleatoria <span class="math inline">\(n\)</span>. Para obtener el estimador de máxima verosimilitud, condicional sobre las variables explicativas, es necesario la densidad de <span class="math inline">\(y_i\)</span> dada <span class="math inline">\(\mathbf{x_i}\)</span>. Esto se escribe como:</p>
<p><span class="math display">\[f(y|\mathbf{x_i;\beta})=[G(\mathbf{x_i\beta})]^y[1-G(\mathbf{x_i\beta})]^{1-y},y=0,1 [17]\]</span></p>
<p>Para simplificar, se adsorbe el intercepto en el vector <span class="math inline">\(\mathbf{x_i}\)</span>. La <strong>función log-verosimilitud</strong> para cada observación <span class="math inline">\(i\)</span> es una función de los parámetros y los datos (<span class="math inline">\(\mathbf{x_i;y_i}\)</span>)), aplicando el logaritmo a la anterior ecuación tenemos:</p>
<p><span class="math display">\[\mathcal{l_i(\beta)}=y_ilog[G(\mathbf{x_i\beta})]+(1-y)log[1-G(\mathbf{x_i\beta})] [18]\]</span> Como <span class="math inline">\(G(.)\)</span> está estrictamente definida entre cero y uno para logit y probit, <span class="math inline">\(\mathcal{l_i(\beta)}\)</span> está bien definida para todos los valores <span class="math inline">\(\beta\)</span></p>
<p>La log-verosimilitud para un tamaño de muestra <span class="math inline">\(n\)</span> se obtiene al sumar todas las observación de la ecuación anterior:</p>
<p><span class="math display">\[\mathcal{L_i(\beta)=\Sigma_{i=1}^n}\mathcal{l_i(\beta)}[19]\]</span> La EMV de <span class="math inline">\(\beta\)</span>, denotada como <span class="math inline">\(\widehat{\beta}\)</span>, maximiza esta log-verosimilitud. Si <span class="math inline">\(G(.)\)</span> es la fda logit estándar, entonces <span class="math inline">\(\widehat{\beta}\)</span> será el estimador Logit; si <span class="math inline">\(G(.)\)</span> es la fda normal estándar, entonces <span class="math inline">\(\widehat{\beta}\)</span> será el estimador Probit.</p>
</section>
<section id="ejemplos-de-aplicación" class="level3" data-number="3.6.6">
<h3 data-number="3.6.6" class="anchored" data-anchor-id="ejemplos-de-aplicación"><span class="header-section-number">3.6.6</span> Ejemplos de aplicación</h3>
<p>Continuaremos con los ejemplos usados en el MPL, como son: la Participación en la fuerza laboral de las mujeres casadas, un modelo de probabilidad para arrestos y, sumaremos el ejemplo de la denegación de una hipoteca <span class="citation" data-cites="stock2012">(<a href="#ref-stock2012" role="doc-biblioref">Stock and Watson 2012</a>)</span></p>
<section id="logit-para-los-datos-hmda" class="level4" data-number="3.6.6.1">
<h4 data-number="3.6.6.1" class="anchored" data-anchor-id="logit-para-los-datos-hmda"><span class="header-section-number">3.6.6.1</span> Logit para los datos HMDA</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(HMDA)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>HMDA <span class="sc">|&gt;</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   2380 obs. of  14 variables:
 $ deny     : Factor w/ 2 levels "no","yes": 1 1 1 1 1 1 1 1 2 1 ...
 $ pirat    : num  0.221 0.265 0.372 0.32 0.36 ...
 $ hirat    : num  0.221 0.265 0.248 0.25 0.35 ...
 $ lvrat    : num  0.8 0.922 0.92 0.86 0.6 ...
 $ chist    : Factor w/ 6 levels "1","2","3","4",..: 5 2 1 1 1 1 1 2 2 2 ...
 $ mhist    : Factor w/ 4 levels "1","2","3","4": 2 2 2 2 1 1 2 2 2 1 ...
 $ phist    : Factor w/ 2 levels "no","yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ unemp    : num  3.9 3.2 3.2 4.3 3.2 ...
 $ selfemp  : Factor w/ 2 levels "no","yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ insurance: Factor w/ 2 levels "no","yes": 1 1 1 1 1 1 1 1 2 1 ...
 $ condomin : Factor w/ 2 levels "no","yes": 1 1 1 1 1 1 2 1 1 1 ...
 $ afam     : Factor w/ 2 levels "no","yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ single   : Factor w/ 2 levels "no","yes": 1 2 1 1 1 1 2 1 1 2 ...
 $ hschool  : Factor w/ 2 levels "no","yes": 2 2 2 2 2 2 2 2 2 2 ...</code></pre>
</div>
</div>
</section>
<section id="la-participación-den-la-fuerza-laboral-de-las-mujeres-casadas" class="level4" data-number="3.6.6.2">
<h4 data-number="3.6.6.2" class="anchored" data-anchor-id="la-participación-den-la-fuerza-laboral-de-las-mujeres-casadas"><span class="header-section-number">3.6.6.2</span> La participación den la fuerza laboral de las mujeres casadas</h4>
<section id="modelo-probit-estimado-con-fda-normal-estándar" class="level5" data-number="3.6.6.2.1">
<h5 data-number="3.6.6.2.1" class="anchored" data-anchor-id="modelo-probit-estimado-con-fda-normal-estándar"><span class="header-section-number">3.6.6.2.1</span> Modelo Probit estimado con fda normal estándar</h5>
<p>Para estimar modelos de variable dependiente limitada se usa el comando <em>glm()</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"mroz"</span>, <span class="at">package =</span> <span class="st">"wooldridge"</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>MPL.mroz <span class="ot">&lt;-</span><span class="fu">lm</span>(inlf<span class="sc">~</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>                 nwifeinc<span class="sc">+</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>                 educ<span class="sc">+</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>                 exper<span class="sc">+</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>                 expersq<span class="sc">+</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>                 age<span class="sc">+</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>                 kidslt6<span class="sc">+</span></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>                 kidsge6,</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> mroz) </span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>mroz.probit <span class="ot">&lt;-</span> <span class="fu">glm</span>(inlf<span class="sc">~</span></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>                 nwifeinc<span class="sc">+</span></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>                 educ<span class="sc">+</span></span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>                 exper<span class="sc">+</span></span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>                 expersq<span class="sc">+</span></span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>                 age<span class="sc">+</span></span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>                 kidslt6<span class="sc">+</span></span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>                 kidsge6,</span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> mroz,</span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"probit"</span>))</span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb90-26"><a href="#cb90-26" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(MPL.mroz, mroz.probit, <span class="at">type =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=====================================================
                           Dependent variable:       
                    ---------------------------------
                                  inlf               
                              OLS            probit  
                              (1)              (2)   
-----------------------------------------------------
nwifeinc                   -0.003**         -0.012** 
                            (0.001)          (0.005) 
                                                     
educ                       0.038***         0.131*** 
                            (0.007)          (0.025) 
                                                     
exper                      0.039***         0.123*** 
                            (0.006)          (0.019) 
                                                     
expersq                    -0.001***        -0.002***
                           (0.0002)          (0.001) 
                                                     
age                        -0.016***        -0.053***
                            (0.002)          (0.008) 
                                                     
kidslt6                    -0.262***        -0.868***
                            (0.034)          (0.118) 
                                                     
kidsge6                      0.013            0.036  
                            (0.013)          (0.044) 
                                                     
Constant                   0.586***           0.270  
                            (0.154)          (0.508) 
                                                     
-----------------------------------------------------
Observations                  753              753   
R2                           0.264                   
Adjusted R2                  0.257                   
Log Likelihood                              -401.302 
Akaike Inf. Crit.                            818.604 
Residual Std. Error    0.427 (df = 745)              
F Statistic         38.218*** (df = 7; 745)          
=====================================================
Note:                     *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<section id="cómo-funciona-la-mecánica-del-modelo-probit" class="level6" data-number="3.6.6.2.1.1">
<h6 data-number="3.6.6.2.1.1" class="anchored" data-anchor-id="cómo-funciona-la-mecánica-del-modelo-probit"><span class="header-section-number">3.6.6.2.1.1</span> ¿Cómo funciona la mecánica del modelo Probit?</h6>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>mroz.probit.simple <span class="ot">&lt;-</span><span class="fu">glm</span>(inlf<span class="sc">~</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>                           kidslt6,</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> mroz,</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"probit"</span>))</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>mroz.probit.simple1 <span class="ot">&lt;-</span><span class="fu">glm</span>(inlf<span class="sc">~</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>                           nwifeinc,</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> mroz,</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"probit"</span>))</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>stargazer<span class="sc">::</span><span class="fu">stargazer</span>(mroz.probit.simple1, <span class="at">type =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=============================================
                      Dependent variable:    
                  ---------------------------
                             inlf            
---------------------------------------------
nwifeinc                   -0.013***         
                            (0.004)          
                                             
Constant                   0.432***          
                            (0.094)          
                                             
---------------------------------------------
Observations                  753            
Log Likelihood             -509.662          
Akaike Inf. Crit.          1,023.324         
=============================================
Note:             *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(mroz<span class="sc">$</span>kidslt6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2377158</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># EFectos en cambios puntuales</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>prediccion<span class="ot">&lt;-</span><span class="fu">predict</span>(mroz.probit.simple,</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="st">"kidslt6"</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)),</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(prediccion)<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       2 
-18.7173 </code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="presentación-del-modelo-estimado" class="level4" data-number="3.6.6.3">
<h4 data-number="3.6.6.3" class="anchored" data-anchor-id="presentación-del-modelo-estimado"><span class="header-section-number">3.6.6.3</span> Presentación del modelo estimado</h4>
<p><strong>Modelo probit simple</strong></p>
<p><span class="math display">\[
\widehat{P(infl=1|kidslt6)}=\Phi \left(0.299-0.539kidslt6\right)
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fu">coef</span>(mroz.probit.simple)[<span class="dv">1</span>]<span class="sc">+</span><span class="fu">coef</span>(mroz.probit.simple)[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">pnorm</span>(<span class="fu">coef</span>(mroz.probit.simple)[<span class="dv">1</span>]<span class="sc">+</span><span class="fu">coef</span>(mroz.probit.simple)[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
  -0.187173 </code></pre>
</div>
</div>
<p><strong>Ecuación estimada de probit</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mroz.probit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)     nwifeinc         educ        exper      expersq          age 
 0.270073573 -0.012023637  0.130903969  0.123347168 -0.001887067 -0.052852442 
     kidslt6      kidsge6 
-0.868324680  0.036005611 </code></pre>
</div>
</div>
<p><span class="math display">\[
\begin{aligned}
P(inlf&amp;=1|nwifeinc,...,kidsge6)=\\
&amp;\Phi(0.27-0.012nwifeinc+0.131educ+0.12exper\\
&amp;-0.0019exper^2-0.053age-0.87kidslt6+0.036kidsg6)
\end{aligned}
\]</span></p>
<p>¿Cuál es la probabilidad de salir de que María salga a trabajar, dado que tiene su esposo un ingreso mensual 300USD, tiene 4 años de educación, nunca ha trabajo, tiene 29 años y un niño de 3 años?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mroz.probit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)     nwifeinc         educ        exper      expersq          age 
 0.270073573 -0.012023637  0.130903969  0.123347168 -0.001887067 -0.052852442 
     kidslt6      kidsge6 
-0.868324680  0.036005611 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pregunta inicial</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>prediccion<span class="ot">&lt;-</span><span class="fu">predict</span>(mroz.probit,</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="st">"nwifeinc"</span><span class="ot">=</span>(<span class="dv">300</span><span class="sc">*</span><span class="dv">12</span>)<span class="sc">/</span><span class="dv">1000</span>,</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"educ"</span><span class="ot">=</span><span class="dv">4</span>,</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"exper"</span><span class="ot">=</span><span class="dv">0</span>,</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"expersq"</span><span class="ot">=</span><span class="dv">0</span>,</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"age"</span><span class="ot">=</span><span class="dv">29</span>,</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"kidslt6"</span><span class="ot">=</span><span class="dv">1</span>,</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"kidsge6"</span><span class="ot">=</span><span class="dv">0</span>),</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mroz.probit,</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="st">"nwifeinc"</span><span class="ot">=</span>(<span class="dv">300</span><span class="sc">*</span><span class="dv">12</span>)<span class="sc">/</span><span class="dv">1000</span>,</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"educ"</span><span class="ot">=</span><span class="dv">4</span>,</span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"exper"</span><span class="ot">=</span><span class="dv">0</span>,</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"expersq"</span><span class="ot">=</span><span class="dv">0</span>,</span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"age"</span><span class="ot">=</span><span class="dv">29</span><span class="sc">+</span><span class="dv">3</span>,</span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"kidslt6"</span><span class="ot">=</span><span class="dv">1</span>,</span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"kidsge6"</span><span class="ot">=</span><span class="dv">1</span>),</span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         1 
0.03809838 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Diferencia</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>cambio <span class="ot">&lt;-</span> <span class="fu">predict</span>(mroz.probit,</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="st">"nwifeinc"</span><span class="ot">=</span>(<span class="dv">300</span><span class="sc">*</span><span class="dv">12</span>)<span class="sc">/</span><span class="dv">1000</span>,</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"educ"</span><span class="ot">=</span><span class="dv">4</span>,</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"exper"</span><span class="ot">=</span><span class="dv">0</span>,</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"expersq"</span><span class="ot">=</span><span class="dv">0</span>,</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"age"</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">29</span>,<span class="dv">29</span><span class="sc">+</span><span class="dv">3</span>),</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"kidslt6"</span><span class="ot">=</span><span class="dv">1</span>,</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"kidsge6"</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)),</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(cambio)<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        2 
-1.130756 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># En el MPL</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>cambio.MPL <span class="ot">&lt;-</span> <span class="fu">predict</span>(MPL.mroz,</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="st">"nwifeinc"</span><span class="ot">=</span>(<span class="dv">300</span><span class="sc">*</span><span class="dv">12</span>)<span class="sc">/</span><span class="dv">1000</span>,</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"educ"</span><span class="ot">=</span><span class="dv">4</span>,</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"exper"</span><span class="ot">=</span><span class="dv">0</span>,</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"expersq"</span><span class="ot">=</span><span class="dv">0</span>,</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"age"</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">29</span>,<span class="dv">29</span><span class="sc">+</span><span class="dv">3</span>),</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"kidslt6"</span><span class="ot">=</span><span class="dv">1</span>,</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"kidsge6"</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)),</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(cambio.MPL)<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        2 
-3.526018 </code></pre>
</div>
</div>
</section>
<section id="modelo-logit-estimado-con-fda-logística-estándar" class="level4" data-number="3.6.6.4">
<h4 data-number="3.6.6.4" class="anchored" data-anchor-id="modelo-logit-estimado-con-fda-logística-estándar"><span class="header-section-number">3.6.6.4</span> Modelo Logit estimado con FDA logística estándar</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>mroz.logit <span class="ot">&lt;-</span> <span class="fu">glm</span>(inlf<span class="sc">~</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>                 nwifeinc<span class="sc">+</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>                 educ<span class="sc">+</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>                 exper<span class="sc">+</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>                 expersq<span class="sc">+</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>                 age<span class="sc">+</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>                 kidslt6<span class="sc">+</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>                 kidsge6,</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> mroz,</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(mroz.logit, <span class="at">type =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=============================================
                      Dependent variable:    
                  ---------------------------
                             inlf            
---------------------------------------------
nwifeinc                   -0.021**          
                            (0.008)          
                                             
educ                       0.221***          
                            (0.043)          
                                             
exper                      0.206***          
                            (0.032)          
                                             
expersq                    -0.003***         
                            (0.001)          
                                             
age                        -0.088***         
                            (0.015)          
                                             
kidslt6                    -1.443***         
                            (0.204)          
                                             
kidsge6                      0.060           
                            (0.075)          
                                             
Constant                     0.425           
                            (0.860)          
                                             
---------------------------------------------
Observations                  753            
Log Likelihood             -401.765          
Akaike Inf. Crit.           819.530          
=============================================
Note:             *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<section id="cómo-funciona-la-mecánica-del-modelo-logit" class="level6" data-number="3.6.6.4.0.1">
<h6 data-number="3.6.6.4.0.1" class="anchored" data-anchor-id="cómo-funciona-la-mecánica-del-modelo-logit"><span class="header-section-number">3.6.6.4.0.1</span> ¿Cómo funciona la mecánica del modelo Logit?</h6>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>mroz.logit.simple <span class="ot">&lt;-</span><span class="fu">glm</span>(inlf<span class="sc">~</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>                           kidslt6,</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> mroz,</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(mroz.probit.simple, <span class="at">type =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=============================================
                      Dependent variable:    
                  ---------------------------
                             inlf            
---------------------------------------------
kidslt6                    -0.539***         
                            (0.094)          
                                             
Constant                   0.299***          
                            (0.051)          
                                             
---------------------------------------------
Observations                  753            
Log Likelihood             -497.367          
Akaike Inf. Crit.           998.734          
=============================================
Note:             *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># EFectos en cambios puntuales</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>prediccion<span class="ot">&lt;-</span><span class="fu">predict</span>(mroz.logit.simple,</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="st">"kidslt6"</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)),</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(prediccion)<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        2 
-18.29326 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="cf">function</span>(z) <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>z))</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lambda</span>(<span class="fu">coef</span>(mroz.logit.simple)[<span class="dv">1</span>]<span class="sc">+</span><span class="fu">coef</span>(mroz.logit.simple)[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">-</span><span class="fu">lambda</span>(<span class="fu">coef</span>(mroz.logit.simple)[<span class="dv">1</span>]<span class="sc">+</span><span class="fu">coef</span>(mroz.logit.simple)[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
  -18.29326 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificando que las probabilidades ajustadas se encuentren entre 0 y 1</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mroz.probit<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
0.002475 0.370959 0.609546 0.570109 0.794345 0.979904 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mroz.logit<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
0.008672 0.366410 0.610925 0.568393 0.796721 0.968541 </code></pre>
</div>
</div>
<p><strong>Presentación del modelo estimado</strong></p>
<p><span class="math display">\[P(inlf=1|nwifeinc,...,kidsge6)=\Lambda(0.425-0.021nwifeinc+...+0.060kidsge6)\]</span></p>
</section>
</section>
<section id="comparación-de-los-modelos-mpl-logit-y-probit" class="level4" data-number="3.6.6.5">
<h4 data-number="3.6.6.5" class="anchored" data-anchor-id="comparación-de-los-modelos-mpl-logit-y-probit"><span class="header-section-number">3.6.6.5</span> Comparación de los modelos MPL, Logit y Probit</h4>
<p>Para esta comparación se va usar los errores heterocedástico robustos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>eher<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(MPL.mroz, <span class="at">type =</span> <span class="st">"HC1"</span>))),</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(mroz.logit, <span class="at">type =</span> <span class="st">"HC1"</span>))),</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>           <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(mroz.probit, <span class="at">type =</span> <span class="st">"HC1"</span>))))</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(MPL.mroz, mroz.logit, mroz.probit,</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">se =</span> eher,</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">"text"</span>,</span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Tabla 2: Estimaciones MPL, logit y probit de la participación en la fuerza laboral"</span>,</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">df=</span>F,</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">header =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Tabla 2: Estimaciones MPL, logit y probit de la participación en la fuerza laboral
=================================================
                         Dependent variable:     
                    -----------------------------
                                inlf             
                       OLS    logistic   probit  
                       (1)       (2)       (3)   
-------------------------------------------------
nwifeinc            -0.003**  -0.021**  -0.012** 
                     (0.002)   (0.009)   (0.006) 
                                                 
educ                0.038***  0.221***  0.131*** 
                     (0.007)   (0.045)   (0.026) 
                                                 
exper               0.039***  0.206***  0.123*** 
                     (0.006)   (0.032)   (0.019) 
                                                 
expersq             -0.001*** -0.003*** -0.002***
                    (0.0002)   (0.001)   (0.001) 
                                                 
age                 -0.016*** -0.088*** -0.053***
                     (0.002)   (0.015)   (0.008) 
                                                 
kidslt6             -0.262*** -1.443*** -0.868***
                     (0.032)   (0.204)   (0.117) 
                                                 
kidsge6               0.013     0.060     0.036  
                     (0.014)   (0.080)   (0.047) 
                                                 
Constant            0.586***    0.425     0.270  
                     (0.152)   (0.864)   (0.507) 
                                                 
-------------------------------------------------
Observations           753       753       753   
R2                    0.264                      
Adjusted R2           0.257                      
Log Likelihood                -401.765  -401.302 
Akaike Inf. Crit.              819.530   818.604 
Residual Std. Error   0.427                      
F Statistic         38.218***                    
=================================================
Note:                 *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p>Como podemos ver en la tabla 2 los signos y la significancia es la misma para todas las variables en los tres modelos. Por ejemplo, la variable <em>educ</em> y <em>exper</em> son estadísticamente significativas en los tres modelos y ambas tienen un signo positivo respecto a la probabilidad de la participación en la fuerza laboral de las mujeres. En un primer momento no es posible comparar las estimaciones logit y probit con las del MPL. Para hacerlas comparables se debe usar el <strong>efecto parcial promedio (EPP)</strong>. Wooldridge (2010, 585) siguiere factores escalares que se deben pre-multiplicar por los coeficientes de logit y probit para hacerlos comparables con el MPL. Para Probit es 0.301 y para logit es 0.179.</p>
<p><strong>Usando factores escalares logit y probit para comparar con coeficientes MPL</strong></p>
<p>El ejemplo de la variable <em>educ</em>. Si multiplico el coeficiente de <em>educ</em> en logit por su factor se obtiene: <span class="math inline">\(0.179(0.221)\approx0.040\)</span> y coeficiente probit <em>educ</em> es de alrededor de <span class="math inline">\(0.301(0.131)\approx0.039\)</span>.Como se puede observar, ambos coeficientes son muy cercanos a la estimación de MPL que es de <span class="math inline">\(0.038\)</span>. También la variable discreta <em>kidslt6</em>, los coeficientes escalados logit y probit son similares al coeficiente del MPL de <span class="math inline">\(-0.262\)</span>. Estos son <span class="math inline">\(0.179(-1.443)\approx-0.258\)</span> (logit) y, <span class="math inline">\(0.301(-0.868)\approx-0.261\)</span> (probit)</p>
<p>La mayor diferencia entre el modelo MPL y los modelos logit y probit es que el MPL supone efectos <em>constantes</em> para <em>educ</em>, <em>exper</em>, <em>kidslt6</em>, etc., mientras que los modelos logit y probit implican magnitudes decrecientes de los efectos parciales</p>
</section>
<section id="curva-decreciente" class="level4" data-number="3.6.6.6">
<h4 data-number="3.6.6.6" class="anchored" data-anchor-id="curva-decreciente"><span class="header-section-number">3.6.6.6</span> Curva decreciente</h4>
<p>En esta sección vamos a observar como los modelos no lineales logit y probit muestran que no es lo mismo tener niño pequeño, dos o tres, etc, para reducir la probabilidad de salir a trabajar</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>mpl.simple <span class="ot">&lt;-</span> <span class="fu">lm</span>(inlf<span class="sc">~</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>                   kidslt6,</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>                 mroz)</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> mroz<span class="sc">$</span>kidslt6,</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">y=</span> mroz<span class="sc">$</span>inlf,</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Modelo probit para los determinates del trabajo femenino"</span>,</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Niños menore a seis años"</span>,</span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Infl, si una mujer casada sale a trabajar por un salario"</span>,</span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch=</span><span class="dv">20</span>,</span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>, <span class="fl">1.4</span>),</span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>,<span class="dv">8</span>))</span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Añadir las lineas horizontales y el texto</span></span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">1</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"darkred"</span>)</span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"darkred"</span>)</span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">2.5</span>, <span class="fl">0.9</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="st">"Sale a trabajar"</span>)</span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">2.5</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="st">"No sale a trabajar"</span>)</span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a><span class="co"># añadiendo la linea de regresión probit</span></span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">7</span>,<span class="dv">1</span>)</span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">predict</span>(mroz.probit.simple, </span>
<span id="cb124-22"><a href="#cb124-22" aria-hidden="true" tabindex="-1"></a>             <span class="fu">list</span>(<span class="at">kidslt6=</span>x), </span>
<span id="cb124-23"><a href="#cb124-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb124-24"><a href="#cb124-24" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,y,<span class="at">lwd=</span><span class="fl">1.5</span>, <span class="at">col=</span><span class="st">"steelblue"</span>)</span>
<span id="cb124-25"><a href="#cb124-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-26"><a href="#cb124-26" aria-hidden="true" tabindex="-1"></a><span class="co"># añadiendo la linea de regresión logit</span></span>
<span id="cb124-27"><a href="#cb124-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-28"><a href="#cb124-28" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">predict</span>(mroz.logit.simple, </span>
<span id="cb124-29"><a href="#cb124-29" aria-hidden="true" tabindex="-1"></a>             <span class="fu">list</span>(<span class="at">kidslt6=</span>x), </span>
<span id="cb124-30"><a href="#cb124-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb124-31"><a href="#cb124-31" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,t,<span class="at">lwd=</span><span class="fl">1.5</span>, <span class="at">col=</span><span class="st">"pink"</span>)</span>
<span id="cb124-32"><a href="#cb124-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-33"><a href="#cb124-33" aria-hidden="true" tabindex="-1"></a><span class="co"># añadiendo la linea de regresión MPL</span></span>
<span id="cb124-34"><a href="#cb124-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-35"><a href="#cb124-35" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">predict</span>(mpl.simple, </span>
<span id="cb124-36"><a href="#cb124-36" aria-hidden="true" tabindex="-1"></a>             <span class="fu">list</span>(<span class="at">kidslt6=</span>x), </span>
<span id="cb124-37"><a href="#cb124-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb124-38"><a href="#cb124-38" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,m,<span class="at">lwd=</span><span class="fl">1.5</span>, <span class="at">col=</span><span class="st">"green"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cap1_files/figure-html/Curva decreciente-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="interpretaciones-de-las-estimaciones-logit-y-probit" class="level3" data-number="3.6.7">
<h3 data-number="3.6.7" class="anchored" data-anchor-id="interpretaciones-de-las-estimaciones-logit-y-probit"><span class="header-section-number">3.6.7</span> Interpretaciones de las estimaciones Logit y Probit</h3>
<p>Las estimaciones de coeficientes, sus errores estándar y el valor de la función de log-verosimilitud se pueden obtener mediante todos los paquetes de software (R) que realicen logit y probit, y se deben reportar en cualquier aplicación. Los coeficientes dan los signos de los efectos parciales de cada <span class="math inline">\(x_j\)</span> sobre la probabilidad de respuesta y la significancia estadística de <span class="math inline">\(x_j\)</span> está determinada por si se puede rechazar <span class="math inline">\(H_0:\beta_j=0\)</span> a un nivel de significancia (<span class="math inline">\(\alpha\)</span>).</p>
<p>Como vimos anteriormente para el MPL se puede calcular el <strong>porcentaje predicho correctamente</strong></p>
<p>Existen varias medidas de bondad de ajuste como <strong>pseudo R-cuadradas</strong>. MacFadden (1974) sugiere la medida <span class="math inline">\(1-\frac{\mathscr{L}_{nr}}{\mathscr{L}_{o}}\)</span>, donde <span class="math inline">\(\mathscr{L}_{nr}\)</span> es la función de log-verosimilitud para el modelo estimado y,<span class="math inline">\(\mathscr{L}_{o}\)</span> es la función de probabilidad de log en el modelo con sólo un intercepto. ¿Por qué esta medida es lógica? Recordar que las log-verosimilitud son negativas y, por tanto <span class="math inline">\(\frac{\mathscr{L}_{nr}}{\mathscr{L}_{o}}=\frac{|\mathscr{L}_{nr}|}{|\mathscr{L}_{o}|}\)</span>. Además. <span class="math inline">\(|\mathscr{L}_{nr}|\leq|\mathscr{L}_{o}|\)</span>. Si las covarianzas no tiene poder explicativo, entonces <span class="math inline">\(\frac{\mathscr{L}_{nr}}{\mathscr{L}_{o}}=1\)</span>, la <strong>pseudo R-cuadrada</strong> será igual a cero, como la R-cuadrada usual es cero en una regresión lineal cuando las covariadas no tienen poder explicativo.</p>
<p>Por lo general, <span class="math inline">\(|\mathscr{L}_{nr}|&lt;|\mathscr{L}_{o}|\)</span>, en cuyo caso <span class="math inline">\(1-\frac{\mathscr{L}_{nr}}{\mathscr{L}_{o}}&gt;0\)</span>. Supongamos que <span class="math inline">\(\mathscr{L}_{nr}\rightarrow0\)</span>, la pseudo-Rcuadrada tiene a uno. Pero en los modelos logit y probit no pueden llegar a cero <span class="math inline">\(\mathscr{L}_{nr}\)</span> ya que eso requeriría que las probabilidades estimadas cuando <span class="math inline">\(y_i=1\)</span> fueran iguales a la unidad y que las probabilidades estimadas cuando <span class="math inline">\(y_i=0\)</span> fueran todas iguales a cero</p>
</section>
<section id="cálculo-de-la-speudo-r2-de-macfadden" class="level3" data-number="3.6.8">
<h3 data-number="3.6.8" class="anchored" data-anchor-id="cálculo-de-la-speudo-r2-de-macfadden"><span class="header-section-number">3.6.8</span> Cálculo de la speudo-<span class="math inline">\(R^2\)</span> de MacFadden</h3>
<p>Segun Stock y Watson (2011), las llamadas pseudo-<span class="math inline">\(R^2\)</span> se usan para medir la calidad del ajuste, estas medidas comparan el valor de la probabilidad máxima log-verosimulitud con todos los regresores, con la probabilidad de un modelo sin regresores (modelo nulo) <strong>regresión en una constante</strong></p>
<p>Por ejemplo, considere una regresión Probit. El <strong>pseudo-</strong><span class="math inline">\(R^2\)</span> esta dado por:</p>
<p><span class="math display">\[pseudo-R^2=1-\frac{ln(f^{max}_{full})}{ln(f^{max}_{null})} [20]\]</span> Donde: <span class="math inline">\(f^{max}_j\in[0,1]\)</span> denota la probabilidad máxima para el modelo <span class="math inline">\(j\)</span></p>
<p>El razonamiento detrás de esto, es que, la probabilidad maximizada aumenta a medida que se agregan regresores adicionales al modelo, de manera similar a la disminución en <span class="math inline">\(SRC\)</span> cuando se agregan regresores en un modelo de regresión lineal. Si el modelo completo tiene una probabilidad maximizada similar a la del modelo nulo, el modelo completo no mejora realmente sobre un modelo que usa solo la información en la variable dependiente, por lo que <span class="math inline">\(pseudo-R^2\approx0\)</span>. Si el modelo completo se ajusta muy bien a los datos, la probabilidad maximizada debe estar cerca de <span class="math inline">\(1\)</span>, tal que <span class="math inline">\(ln(f^{max}_{full})\approx0\)</span> y <span class="math inline">\(pseudo-R^2\approx1\)</span></p>
<p>En Rstudio para los modelos estimados con <span class="math inline">\(glm()\)</span> podemos utilizar las entradas de desviación residual <strong>(desviance)</strong> y la desviación nula <strong>(null.desviance)</strong>. Estos han sido calculados de la siguiente forma:</p>
<p><span class="math display">\[desviance=-2\times[ln(f^{max}_{satured})-ln(f^{max}_{full})]\\null.desviance=-2\times[ln(f^{max}_{satured})-ln(f^{max}_{null})]\]</span> Donde: <span class="math inline">\(f^{max}_{satured}\)</span> es la probabilidad maximizada para un modelo que asume que cada observación tiene su propio parámetro (hay <span class="math inline">\(n+1\)</span> parámetros a estimar que conducen a un ajuste perfecto). Para los modelos con una variable dependiente binaria, se tiene que:</p>
<p><span class="math display">\[pseduo-R^2=1-\frac{desviance}{null.desviance}=1-\frac{ln(f^{max}_{full})}{ln(f^{max}_{null})} [21]\]</span> <strong>Cálculo del</strong> <span class="math inline">\(pseudo-R^2\)</span> <strong>para los modelos Logit y Probit</strong> del ejemplo, La participación en la fuerza laboral de las mujeres casadas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Probit</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>pseudo.R2.P <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>(mroz.probit<span class="sc">$</span>deviance<span class="sc">/</span>mroz.probit<span class="sc">$</span>null.deviance)</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>pseudo.R2.P<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 22.05805</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Logit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Si usamos la interpretación usual del <span class="math inline">\(R^2\)</span> de la regresión lineal, diremos que según los <strong>pseudo-R2</strong> de logit y probit, aproximadamente la variación de la probabilidad de la participación en la fuerza laboral de las mujeres casadas esta explicada por las variables regresoras en aproximadamente un 22%.</p>
<p>En cualquier caso, la bondad de ajuste suele ser menos importante que intentar obtener estimaciones convincentes de los efectos <strong>ceteris paribus</strong> de las variables explicativas.</p>
</section>
<section id="efecto-parcial-promedio-y-el-efecto-parcial-en-el-promedio" class="level3" data-number="3.6.9">
<h3 data-number="3.6.9" class="anchored" data-anchor-id="efecto-parcial-promedio-y-el-efecto-parcial-en-el-promedio"><span class="header-section-number">3.6.9</span> Efecto parcial promedio y el efecto parcial en el promedio</h3>
<p>Parte importante de estos modelos es estimar los efectos de las <span class="math inline">\(x_j\)</span> sobre las probabilidades de respuesta, <span class="math inline">\(P(y=1|\mathbf{x})\)</span>. Si <span class="math inline">\(x_j\)</span> es aproximadamente continua teníamos:</p>
<p><span class="math display">\[\Delta \hat{P}(y=1|\mathbf{x})\approx[g(\hat{\beta}_0+\mathbf{x}\hat{\beta})\hat{\beta}_j]\Delta x_j [22]\]</span></p>
<p>Entonces, para pequeños cambios en <span class="math inline">\(x_j\)</span>. Así que, para <span class="math inline">\(\Delta x_j=1\)</span> el cambio en la probabilidad de éxito es aproximadamente <span class="math inline">\(g(\hat{\beta}_0+\mathbf{x}\hat{\beta})\hat{\beta}_j\)</span>. En comparación con el MPL, el costo de usar modelos probit y logit es que los efectos parciales en la ecuación anterior son más difíciles de resumir debido a que el factor de escala <span class="math inline">\(g(\hat{\beta}_0+\mathbf{x}\hat{\beta})\)</span>, depende de <span class="math inline">\(\mathbf{x}\)</span>. Una posibilidad es insertar valores interesante para las <span class="math inline">\(x_j\)</span> (medias, medianas, mínimos, máximos, cuartíles, etc.) y, ver como cambia <span class="math inline">\(g(\hat{\beta}_0+\mathbf{x}\hat{\beta})\)</span>. Pero, a pesar de ser un proceso atractivo es tedioso y puede dar como resultado demasiada información aun si el número de variables explicativas es moderado.</p>
<p>Como resumen rápido para obtener magnitudes de efectos parciales, es útil tener un factor escalar único que se pueda multiplicar con cada <span class="math inline">\(\widehat{\beta}_j\)</span> (o al menos aquellos coeficiente de variables aproximadamente continuas). Un método que suele usarse en paquetes econométricos es reemplazar cada variable explicativas con su promedio muestral. En otras palabras, el factor de ajuste es:</p>
<p><span class="math display">\[g(\hat{\beta}_0+\bar{\mathbf{x}}\hat{\beta})=g(\hat{\beta}_0+\hat{\beta}_1\bar{x}_1+\hat{\beta}_2\bar{x}_2+...+\hat{\beta}_k\bar{x}_k) [23]\]</span> Donde: <span class="math inline">\(g(.)\)</span> es la densidad normal estándar <span class="math inline">\((\phi)\)</span> para el caso probit y, <span class="math inline">\(g(z)=\frac{exp(z)}{[1+exp(z)]^2}\)</span> para logit. Cuando a la ecuación anterior se multiplica por <span class="math inline">\(\widehat{\beta}_j\)</span> obtenemos el efecto de <span class="math inline">\(x_j\)</span> para la persona promedio en la muestra. Por lo tanto, si multiplico el coeficiente <span class="math inline">\(\beta_j\)</span> por la ecuación [23], se obtiene el <strong>efecto parcial en el promedio (EPeP)</strong>.</p>
<section id="ejemplo-con-los-determinantes-del-trabajo-femenino" class="level4" data-number="3.6.9.1">
<h4 data-number="3.6.9.1" class="anchored" data-anchor-id="ejemplo-con-los-determinantes-del-trabajo-femenino"><span class="header-section-number">3.6.9.1</span> Ejemplo con los determinantes del trabajo femenino</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"mroz"</span>, <span class="at">package =</span> <span class="st">"wooldridge"</span>)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>Epep.probit <span class="ot">&lt;-</span> <span class="fu">glm</span>(inlf<span class="sc">~</span>nwifeinc,</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>                  mroz, </span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"probit"</span>)) </span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>stargazer<span class="sc">::</span><span class="fu">stargazer</span>(Epep.probit, <span class="at">type =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=============================================
                      Dependent variable:    
                  ---------------------------
                             inlf            
---------------------------------------------
nwifeinc                   -0.013***         
                            (0.004)          
                                             
Constant                   0.432***          
                            (0.094)          
                                             
---------------------------------------------
Observations                  753            
Log Likelihood             -509.662          
Akaike Inf. Crit.          1,023.324         
=============================================
Note:             *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p>Una vez que tengo el modelo, lo uso para ejemplificar el <strong>EPeP</strong>,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dnorm</span>(<span class="fu">coef</span>(Epep.probit)[<span class="dv">1</span>]<span class="sc">+</span><span class="fu">coef</span>(Epep.probit)[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">mean</span>(mroz<span class="sc">$</span>nwifeinc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
  0.3929979 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="cf">function</span>(z) (<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>z<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="fu">phi</span>(<span class="fu">coef</span>(Epep.probit)[<span class="dv">1</span>]<span class="sc">+</span><span class="fu">coef</span>(Epep.probit)[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">mean</span>(mroz<span class="sc">$</span>nwifeinc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
  0.3929979 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Efecto de aumentar el salario en una unidad son 1000 USD</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dnorm</span>(<span class="fu">coef</span>(Epep.probit)[<span class="dv">1</span>]<span class="sc">+</span><span class="fu">coef</span>(Epep.probit)[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">mean</span>(mroz<span class="sc">$</span>nwifeinc))<span class="sc">*</span><span class="fu">coef</span>(Epep.probit)[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
 -0.5052942 </code></pre>
</div>
</div>
<p>El mismo ejemplo para <strong>logit</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>Epep.logit <span class="ot">&lt;-</span> <span class="fu">glm</span>(inlf<span class="sc">~</span>nwifeinc,</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>                  mroz, </span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)) </span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>stargazer<span class="sc">::</span><span class="fu">stargazer</span>(Epep.logit, <span class="at">type =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=============================================
                      Dependent variable:    
                  ---------------------------
                             inlf            
---------------------------------------------
nwifeinc                   -0.021***         
                            (0.007)          
                                             
Constant                   0.695***          
                            (0.152)          
                                             
---------------------------------------------
Observations                  753            
Log Likelihood             -509.654          
Akaike Inf. Crit.          1,023.309         
=============================================
Note:             *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fda logística estándar</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>lambda.minus <span class="ot">&lt;-</span> <span class="cf">function</span>(z) <span class="fu">exp</span>(z)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(z))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lambda.minus</span>(<span class="fu">coef</span>(Epep.logit)[<span class="dv">1</span>]<span class="sc">+</span><span class="fu">coef</span>(Epep.logit)[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">mean</span>(mroz<span class="sc">$</span>nwifeinc))<span class="sc">*</span><span class="fu">coef</span>(Epep.logit)[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">100</span><span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
  -50.91089 </code></pre>
</div>
</div>
<p>Existen dos problemas con el uso del <strong>EPeP</strong>. Primero, si algunas de las variables explicativas son discretas, sus promedios no representan a nadie en la muestra. Por ejemplo, si <span class="math inline">\(x_1=mujeres\)</span> y 47.5% de las muestra son mujeres ¿qué sentido tiene insertar <span class="math inline">\(\bar{x}_1=0.475\)</span> para representar a la persona “promedio”?. Segundo, si una variable explicativa continua aparece como función no lineal, por ejemplo, como un log-natural o cuadrática, no es claro si se quiere promediar la función no lineal o insertar el promedio en la función no lineal. Por ejemplo, ¿Se debe usar <span class="math inline">\(\bar{log(ventas)}\)</span> o <span class="math inline">\(log(\bar{ventas})\)</span> para representar el tamaño promedio de la empresa?. Los paquetes econométrico se quedan en el primero, el paquete está programado para calcular los promedios de los regresores incluidos en la estimación probit o logit.</p>
<p>Un método diferente para calcular un factor escalar elude la cuestión de qué valores a insertar para las variables explicativas. En lugar de ello, el segundo factor escalar resulta al promediar los efectos parciales individuales a través de la muestra, lo que genera en algunas veces llamado <strong>efecto parcial promedio (EPP)</strong>. Por ejemplo, para una variable aproximadamente continua el <strong>EPP</strong> es:</p>
<p><span class="math display">\[n^{-1}\sum_{i=1}^n[g(\hat{\beta}_0+\mathbf{x}\hat{\beta})\hat{\beta}_j]=n^{-1}\sum_{i=1}^n[g(\hat{\beta}_0+\mathbf{x}\hat{\beta})]\hat{\beta}_j [24]\]</span></p>
<p>El término que se multiplica a <span class="math inline">\(\hat{\beta}_j\)</span> actúa como un factor escalar:</p>
<p><span class="math display">\[
n^{-1}\sum_{i=1}^n[g(\hat{\beta}_0+\mathbf{x}\hat{\beta})] [25]
\]</span> Los factores escalares que sirven para obtener el <em>EPP</em> y <em>EPeP</em> que fueron detallados anteriormente de la aproximación del cálculo, ninguna es lógica para variables explicativas discretas. Es su lugar, se debe estimar directamente el cambio de probabilidad. Para un cambio <span class="math inline">\(x_k\)</span> de <span class="math inline">\(c_k\)</span> a <span class="math inline">\(c_k+1\)</span>, es análogo al efecto parcial en el promedio:</p>
<p><span class="math display">\[G[\hat{\beta}_0+\hat{\beta}_1\bar{x}_1+...+\hat{\beta}_{k-1}\bar{x}_{k-1}+\hat{\beta}_k(c_k+1)]-G[\hat{\beta}_0+\hat{\beta}_1\bar{x}_1+...+\hat{\beta}_{k-1}\bar{x}_{k-1}+\hat{\beta}_kc_k] [26]\]</span> El efecto parcial promedio es:</p>
<p><span class="math display">\[n^{-1}\sum_{i=1}^n(G[\hat{\beta}_0+\hat{\beta}_1x_{i1}+...+\hat{\beta}_{k-1}x_{ik-1}+\hat{\beta}_k(c_k+1)]-G[\hat{\beta}_0+\hat{\beta}_1x_{i1}+...+\hat{\beta}_{k-1}x_{ik-1}+\hat{\beta}_kc_k])[27]\]</span> La función anterior se puede interpretar de forma particular cuando <span class="math inline">\(x_k\)</span> es binaria. Para cada unidad <span class="math inline">\(i\)</span>, se estima la diferencia predicha en la probabilidad de que <span class="math inline">\(y_i=1\)</span> cuando <span class="math inline">\(x_k=1\)</span> y <span class="math inline">\(x_k=0\)</span>, de la siguiente forma:</p>
<p><span class="math display">\[n^{-1}\sum _{i=1}^nG[\hat{\beta}_0+\hat{\beta}_1x_{i1}+...+\hat{\beta}_{k-1}x_{ik-1}+\hat{\beta}_k]-G[\hat{\beta}_0+\hat{\beta}_1x_{i1}+...+\hat{\beta}_{k-1}x_{ik-1}] [28]\]</span> Para finalizar la aplicación de MPL, Logit y Probit. Es importante tener un tipo de efecto marginal que sea interpretable para los modelos no lineales (logit y probit), estos se obtienen de la siguiente manera usando el ejemplo de:</p>
<section id="efecto-parcial-promedio-ejemplo" class="level5" data-number="3.6.9.1.1">
<h5 data-number="3.6.9.1.1" class="anchored" data-anchor-id="efecto-parcial-promedio-ejemplo"><span class="header-section-number">3.6.9.1.1</span> Efecto parcial promedio ejemplo</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Para probit</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">dnorm</span>(<span class="fu">coef</span>(Epep.probit)[<span class="dv">1</span>]<span class="sc">+</span><span class="fu">coef</span>(Epep.probit)[<span class="dv">2</span>]<span class="sc">*</span>mroz<span class="sc">$</span>nwifeinc))<span class="sc">*</span><span class="fu">coef</span>(Epep.probit)[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  nwifeinc 
-0.4998448 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Para logit</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">lambda.minus</span>(<span class="fu">coef</span>(Epep.logit)[<span class="dv">1</span>]<span class="sc">+</span><span class="fu">coef</span>(Epep.logit)[<span class="dv">2</span>]<span class="sc">*</span>mroz<span class="sc">$</span>nwifeinc))<span class="sc">*</span><span class="fu">coef</span>(Epep.logit)[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  nwifeinc 
-0.5021655 </code></pre>
</div>
</div>
<p><strong>[Participación en la fuerza laboral de las mujeres casadas]</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mfx)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Probando lo hecho a mano</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="fu">probitmfx</span>(inlf<span class="sc">~</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>            nwifeinc,</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> mroz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
probitmfx(formula = inlf ~ nwifeinc, data = mroz)

Marginal Effects:
              dF/dx  Std. Err.       z    P&gt;|z|   
nwifeinc -0.0050529  0.0015912 -3.1755 0.001496 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Efectos marginales Probit</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>marginales.probit<span class="ot">&lt;-</span><span class="fu">probitmfx</span>(inlf<span class="sc">~</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>            nwifeinc<span class="sc">+</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>            educ<span class="sc">+</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>            exper<span class="sc">+</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>            expersq<span class="sc">+</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>            age<span class="sc">+</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>            kidslt6<span class="sc">+</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>            kidsge6,</span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> mroz)</span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a>marginales.probit<span class="sc">$</span>mfxest[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  -0.46961881   5.11284287   4.81768957  -0.07370502  -2.06430891
[6] -33.91499645   1.40630594</code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Efectos marginales Logit</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>marginales.logit<span class="ot">&lt;-</span><span class="fu">logitmfx</span>(inlf<span class="sc">~</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>            nwifeinc<span class="sc">+</span></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>            educ<span class="sc">+</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>            exper<span class="sc">+</span></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>            expersq<span class="sc">+</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>            age<span class="sc">+</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>            kidslt6<span class="sc">+</span></span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>            kidsge6,</span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> mroz)</span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a>marginales.logit<span class="sc">$</span>mfxest[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  -0.51900534   5.37773087   5.00569282  -0.07669166  -2.14030205
[6] -35.09498193   1.46162143</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparación entre logit y probit</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>variables<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"nwifeinc"</span>, <span class="st">"educ"</span>, <span class="st">"exper"</span>, <span class="st">"expersq"</span>, <span class="st">"age"</span>, <span class="st">"kidslt6"</span>, <span class="st">"kidsge6"</span>)</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>comparacion <span class="ot">&lt;-</span><span class="fu">data.frame</span>(variables,marginales.logit<span class="sc">$</span>mfxest[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]<span class="sc">*</span><span class="dv">100</span>, marginales.probit<span class="sc">$</span>mfxest[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(comparacion)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Betas"</span>, <span class="st">"Logit"</span>, <span class="st">"Probit"</span>)</span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>comparacion</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Betas        Logit       Probit
1 nwifeinc  -0.51900534  -0.46961881
2     educ   5.37773087   5.11284287
3    exper   5.00569282   4.81768957
4  expersq  -0.07669166  -0.07370502
5      age  -2.14030205  -2.06430891
6  kidslt6 -35.09498193 -33.91499645
7  kidsge6   1.46162143   1.40630594</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100000</span><span class="sc">/</span><span class="dv">12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8333.333</code></pre>
</div>
</div>
<p>Una vez, establecidos los valores de los betas interpretables, podemos pasar a mirar la exactitud del estimaciones de los dos modelos no lineales.</p>
</section>
</section>
</section>
<section id="porcentaje-predicho-correctamente-y-la-matriz-de-confusión" class="level3" data-number="3.6.10">
<h3 data-number="3.6.10" class="anchored" data-anchor-id="porcentaje-predicho-correctamente-y-la-matriz-de-confusión"><span class="header-section-number">3.6.10</span> Porcentaje predicho correctamente y la matriz de confusión</h3>
<p>En lugar de solo calcular el PPC, se presentará la matriz de confusión que permite mostrar cuantas veces el modelo predijo correctamente los valores de <span class="math inline">\(y\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd)</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Probit</span></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>predi.probit <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(mroz.probit<span class="sc">$</span>fitted.values<span class="sc">&gt;</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>MCProbit <span class="ot">&lt;-</span> <span class="fu">table</span>(mroz<span class="sc">$</span>inlf, predi.probit,</span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"observaciones"</span>, <span class="st">"estimaciones"</span>))</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>PPC.probit <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mroz<span class="sc">$</span>inlf, predi.probit, <span class="fu">ifelse</span>(mroz<span class="sc">$</span>inlf<span class="sc">==</span>predi.probit,<span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(PPC.probit)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"infl"</span>, <span class="st">"Valores ajustados"</span>, <span class="st">"PPC"</span>)</span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(PPC.probit<span class="sc">$</span>PPC))[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
73.43958 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaic</span>(MCProbit, </span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">shade =</span> T, </span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">colorize =</span> T,</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"yellow"</span>, <span class="st">"yellow"</span>, <span class="st">"blue"</span>),</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">2</span>,<span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cap1_files/figure-html/matriz_confusion Probit-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmodels)</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="fu">CrossTable</span>(mroz<span class="sc">$</span>inlf, predi.probit,</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">format =</span> <span class="st">"SPSS"</span>,</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">prop.c =</span> F,</span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">prop.chisq =</span> F,</span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">prop.t =</span> F,</span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">dnn=</span><span class="fu">c</span>(<span class="st">"Observado"</span>, <span class="st">"estimado"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   Cell Contents
|-------------------------|
|                   Count |
|             Row Percent |
|-------------------------|

Total Observations in Table:  753 

             | estimado 
   Observado |        0  |        1  | Row Total | 
-------------|-----------|-----------|-----------|
           0 |      205  |      120  |      325  | 
             |    63.08% |    36.92% |    43.16% | 
-------------|-----------|-----------|-----------|
           1 |       80  |      348  |      428  | 
             |    18.69% |    81.31% |    56.84% | 
-------------|-----------|-----------|-----------|
Column Total |      285  |      468  |      753  | 
-------------|-----------|-----------|-----------|

 </code></pre>
</div>
</div>
<p><strong>1. Sensitividad</strong>: % de positivos (1) que sob clasificados como positivos (1). para el modelo probit seria (<span class="math inline">\(\frac{347}{428}= 81.07\%\)</span>)</p>
<p><strong>2. Especificidad</strong>: % negativos(0) que son clasificado como negativops(0). . en nuestro ejemplo_: (<span class="math inline">\(\frac{207}{325}= 63.98\%\)</span>)</p>
<p><strong>Falsos positivos:</strong> % de negativos (o) clasificados como positivos (1). En nuestro ejemplo: (<span class="math inline">\(\frac{120}{325}= 36.92\%\)</span>)</p>
<p><strong>Falsos Negativos:</strong> % de positivos clasificados (1) como negativos (0). en nuestro ejemplo. (<span class="math inline">\(\frac{80}{428}= 18.69\%\)</span>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>predi.logit <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(mroz.logit<span class="sc">$</span>fitted.values<span class="sc">&gt;=</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>m.confu.logit<span class="ot">&lt;-</span> <span class="fu">table</span>(mroz<span class="sc">$</span>inlf, predi.logit,</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"observaciones"</span>, <span class="st">"estimaciones"</span>))</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>PPC.logit <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mroz<span class="sc">$</span>inlf, predi.logit, <span class="fu">ifelse</span>(mroz<span class="sc">$</span>inlf<span class="sc">==</span>predi.logit,<span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(PPC.logit)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"infl"</span>, <span class="st">"Valores ajustados"</span>, <span class="st">"PPC"</span>)</span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(PPC.logit<span class="sc">$</span>PPC))[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
73.57238 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaic</span>(m.confu.logit, <span class="at">shade =</span> T, <span class="at">colorize =</span> T,</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">"green3"</span>, <span class="st">"red2"</span>, <span class="st">"red2"</span>, <span class="st">"green3"</span>),</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">2</span>,<span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cap1_files/figure-html/Logit PPC-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CrossTable</span>(mroz<span class="sc">$</span>inlf, predi.logit,</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">format =</span> <span class="st">"SPSS"</span>,</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">prop.c =</span> F,</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">prop.chisq =</span> F,</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">prop.t =</span> F,</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">dnn=</span><span class="fu">c</span>(<span class="st">"Observado"</span>, <span class="st">"estimado"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   Cell Contents
|-------------------------|
|                   Count |
|             Row Percent |
|-------------------------|

Total Observations in Table:  753 

             | estimado 
   Observado |        0  |        1  | Row Total | 
-------------|-----------|-----------|-----------|
           0 |      207  |      118  |      325  | 
             |    63.69% |    36.31% |    43.16% | 
-------------|-----------|-----------|-----------|
           1 |       81  |      347  |      428  | 
             |    18.93% |    81.07% |    56.84% | 
-------------|-----------|-----------|-----------|
Column Total |      288  |      465  |      753  | 
-------------|-----------|-----------|-----------|

 </code></pre>
</div>
</div>
<p>Los modelos logit y probit son capaces de clasificar correctamente el <span class="math inline">\(73.5%\)</span> de las observaciones cuando se emplean los datos de trabajo femenino.</p>
</section>
<section id="capacidad-discriminante-del-modelo" class="level3" data-number="3.6.11">
<h3 data-number="3.6.11" class="anchored" data-anchor-id="capacidad-discriminante-del-modelo"><span class="header-section-number">3.6.11</span> Capacidad discriminante del modelo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"Epi"</span>)</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ROC</span>(<span class="at">form=</span>inlf<span class="sc">~</span>nwifeinc<span class="sc">+</span></span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>            educ<span class="sc">+</span></span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>            exper<span class="sc">+</span></span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>            expersq<span class="sc">+</span></span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>            age<span class="sc">+</span></span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>            kidslt6<span class="sc">+</span></span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a>            kidsge6,</span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> mroz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cap1_files/figure-html/ROC-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cap1_files/figure-html/ROC-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Sensibilidad</strong>: la probabilidad de que el modelo prediga un resultado positivo (1) para una observación cuando en realidad el resultado es positivo (1)</p>
<p><strong>Especificidad</strong>: La probabilidad de que el modelo prediga un resultado negativo para una observación cuando en realidad el resultado es negativo.</p>
</section>
</section>
<section id="ejercicio-17.2-del-libro-de-wooldridge" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Ejercicio 17.2 del libro de Wooldridge</h1>
<p>Sea <span class="math inline">\(grad\)</span> una variable binaria para si un atleta colegial en una universidad grande se graduará en cinco años. Sean <span class="math inline">\(hsGPA\)</span>y <span class="math inline">\(SAT\)</span> el promedio de calificaciones de bachillerato y las puntuaciones del <span class="math inline">\(SAT\)</span> de admisión a la universidad, respectivamente. Sea <span class="math inline">\(study\)</span> el número de horas por semana que pasa un estudiante en un aula de estudio. Suponga que, usando los datos sobre 420 atletas colegiales se obtiene el siguiente modelo logit:</p>
<p><span class="math display">\[
\widehat{P}(grad=1|hsGPA,SAT,study)=\Lambda(-1.17+0.24hsGPA+0.00058SAT+0.073study)
\]</span> <span class="math display">\[
\Lambda =\frac{exp(z)}{[1+exp(z)]}
\]</span> Si mantiene <span class="math inline">\(hsGPA = 3.0\)</span> y el <span class="math inline">\(SAT = 1200\)</span>, calcule la diferencia estimada en la probabilidad de graduación para alguien que pasa 10 horas a la semana en el aula de estudio y alguien que pasa 5 horas por semana.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span>(<span class="sc">-</span><span class="fl">1.17+0.24</span><span class="sc">*</span><span class="dv">3</span><span class="fl">+0.00058</span><span class="sc">*</span><span class="dv">1200</span><span class="fl">+0.073</span><span class="sc">*</span><span class="dv">10</span>)</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>lambda_5 <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="fl">1.17+0.24</span><span class="sc">*</span><span class="dv">3</span><span class="fl">+0.00058</span><span class="sc">*</span><span class="dv">1200</span><span class="fl">+0.073</span><span class="sc">*</span><span class="dv">5</span>)</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>diferencia <span class="ot">&lt;-</span>(<span class="fu">exp</span>(lambda)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(lambda)))<span class="sc">-</span>(<span class="fu">exp</span>(lambda_5)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(lambda_5)))</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>diferencia<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.814493</code></pre>
</div>
</div>
</section>
<section id="tareas" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Tareas</h1>
<ol type="1">
<li>Tarea: realizar todos los cálculos para el modelo de los arrestos, igual como se hizo en clase para los dos modelos, es decir, con y sin variables binarias.</li>
</ol>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-stock2012" class="csl-entry" role="listitem">
Stock, James H, and Marck M. Watson. 2012. <em>Introducción a la econometría</em>. Madrid (España): Pearson. <a href="http://www.ebooks7-24.com/?il=3445">http://www.ebooks7-24.com/?il=3445</a>.
</div>
<div id="ref-wooldridge2009" class="csl-entry" role="listitem">
Wooldridge, Jeffrey M. 2009. <em>Introductory econometrics: a modern approach</em>. 4th ed. Mason, OH: South Western, Cengage Learning.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./summary.html" class="pagination-link" aria-label="Resumen">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Resumen</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./cap2.html" class="pagination-link" aria-label="Modelo Tobit">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Modelo Tobit</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>